tmk uhunixuhcchawaiiedu thu jun  edt subject improve security newly installed sunos  system summary improve security newly installed sunos  system xnewsreader tin version  pl date thu jun  gmt appologies taking long became much larger though would please note intent limit audience enough document would become large cumbersome please note intended audience document sure undergo revision hesitate ever call revision final draft please forgive typo gramatical error late wanted get day friday send note typo spelling directly nt bother rest net try post able put list ftp server ftphawaiiedu pubsecurity many thanks provided feedback sure list got please let know help                                    improve security newly installed sunos  system version thomas kroeger july  tmk hawaiiedu copyright  thomas kroeger july please feel free redistribute include list part wherever desire please include appropriate citation goal attempt provide list basic step done improve security newly installed sunos  system mean inclusive list action list simple common measure intended audience anyone responsible system administration duty machine running sunos  recommendation applicable standalone workstation assumed reader familiarity basic system administration able basic system installation install patch use editor may connected larger network note list limit coverage measure done standalone workstation addition step listed many measure taken improve security enviornment measure filtering traffic port udp router prevent nfs call outside domain disclaimer  recommendation come guarantee anything support offered within university hawai community truly paranoid may wish implement recommendation single user mode extra measure security avoid possible subversive shenannigans wily cracker system installed                patch  install following patch  security listing sunos     script change file permission sunos  nfs jumbo patch sunos  binmail jumbo patch sunos    jumbo patch ldso ldd ldconf sunos  security update incomsat sunos    netgroup export world sunos    lpr jumbo patch sunos    tfs c work together sunos    sendmail jumbo patch sunos      rdist security hard link openwindows  loadmodule security hole openwindows  xview  jumbo patch openwindows  xlock crash leaving system open sunos     ypserv ypxfrd fix plus dns fi sunos    tmpfs jumbo patch sunos    jumbo tty patch sunos   c jumbo patch sunos  security update dump sunos   ufs jumbo patch sunos    security method exploit loginsu sunos x env variable used exploit login u sunshield  arm jumbo patch release sunos  domestic libc jumbo patch sunos  international libc jumbo patch sunos    security update syslogd sunos    nonrelated data filled last block sunos    security problem expreserve sunos    breach security using modload od  nfsfsirand security fix sunos    security update intalkd sunos    security update write sunos  inftpd log password info option used online disksuite od  security update dump  u security listing sunos u lpr jumbo patch sunos u ypserv fix sunos u binmail jumbo patch sunos u security problem method exploit loginsu sunos u international libc jumbo patch sunos u security problem expreserve solaris sunos u security patch mfree icmp redirect online disksuite od  nfsfsirand security fix sunos u jumbo tty patch sunos u sendmail jumbo patch sunos u breach security using modload sunos u domestic libc jumbo patch note patch may required disabling feature case ensure relevant file mode changed remove suid bit  chmod u file note patch may necessarily apply based package installed u encryption  configuration please carefully check readme patch patch available via anonymous ftp ftpuunet systemsunsundist network level change    disable source routing source routing enables originating host dictate route packet take used spoof system believing packet coming trusted source install patch found ref info ref cheswick chap ref comment unnecessary service etcinetdconf rpc service used gain access well information system site specific adjustment tailored need additionally tcp wrapper ref used improve loging prevent ip spoofing one host pretending another gain access limit access service well totally removing edit file etcinetdconf put front service needed service possibly needed probably desired ftp possible needed file transfer however want outgoing ftp commented telnet obvious recommend restricting tcp wrapper ref finger possibly better get modified version doesnt  give much information honest experience recommend checking one ftpuunet talk nice much miss service probably unnecessary see man page detail name name service man tnamed comsat mail necessary login rlogin please see discussion ruserok uucp nt sure using exec service rexecd without service recommended find way live without shell rsh  major source security problem tftp needed support x terminal diskless client doubtfully needed desktop machine info ref venema ref enable nfs port monitoring value exporting filesystems nfs port monitoring ensures call nfs mount file system come port word port requires root access use default etcrclocal set port monitoring file etcsecuritypasswdadjunct exists implementing shadowing skip step implementing shadowing exporting file modify etcrclocal following line regardless whether passwdadjunct file exists echo  nfsportmonw  adb w vmunix devkmem devnull rpcmountd shadowing covered section change id management note one possible side effect nonsun nfs client might able mount exported file info ref stern pg mountd c ensure ypbind started option user could easily start thier ypbind service activate phony ni database giving access user port monitoring default etcrclocal set ypbind secure mode option file etcsecuritypasswdadjunct exists implementing shadowing skip step overwise modify etcrclocal start ypbind option regardless whether passwdadjunct file exists info ypbind disable ip forwarding sure abused machine one interface rather err side safety could used spoof ip address install following line kernel configuration file option  ipforwarding  info custom configure kernel see file usrsys arch confreadme kernel change    modify ruserok usrliblibcso  u disable root rhosts authentication wildcards rhosts rhosts entirely depending level security want ruserok library routine checking rhosts etchostsequiv file r command ruserok us source ip address rpc request authentication guarantee address correct address easily spoofed yielding illegitimate access system b cracker often insert user rhosts file allow gain access latter date user nt look rhosts file often note using rhosts prevents cracker sniffing user password also make vulnerable ip spoofing claiming host becomes matter preference level protection choose modify source code requires source code license univ hawaii modified version libcso available though system group wish create thier modified version ruserok please see section end describes detail creating custom libcso additionally logdaemon package ref modified version libcso help site also bsd source ruserok routine finally tcp wrapper also used restrict access individual r command ref info ruserok hostsequiv source code file liblibcnetrcmdc ref ref filesystem change      create file etcftpusers file list user allowed access system via ftp prevents joe cracker using ftp modify file etcpasswd able determine root password create file etcftpuser following entry one per line root nobody daemon sys bin uucp news ingres aupwdauthd auyppasswdd sysdiag sundiag id exist nt want allow ftp access info man ftpusers remove etchostsequiv well   everyone gain access note file comment line info hostsequiv edit etcexports remove entry nt want exported ensure whatever entry remain restricted access nfs leaf normal file system protection client instead server acracker root access client work around many protection result filesystems exported world particularly vulnerable edit file etcexports export need export nt certain need exported probably nt never export world use accesshostfoobaredu option ever possible export file system readonly option ro use showmount e see currently exported info export exportfs showmount install random number inode generator filesystems fsirand predicable root handle assist cracker abusing nfs installing patch fsirand need run fsirand filesystems ensure filesystem unmounted run fsirand info fsirand sunos patch nfs jumbo nosuid mount use nosuid option adding entry etcfstab mount filesystem exported another host anyone gaining access host create modify existing program could compromise system note nt work tmpfs filesystems include nosuid add entry etcfstab import filesystem info ref stern pg fstab edit etcttytab remove secure option entry secure entry etcttytab allows logins directly root tty feel machine physically secure location may choose remove secure option console well info ttytab set eeprom secure field command full feel machine secure location eeprom field secure used prevent unauthorized root access crashing machine note full option system autoreboot wait root password entered info eeprom chmod deveeprom prevents user reading eeprom passwd info eeprom remove openprom support intend use eeprom secure field cracker gain root access could install eeprom password make life bit harder remove device driver kernel commenting following  open eeprom  pseudodevice required support eeprom command pseudodevice openeepr onboard configuration nvram info eeprom uncomment security option frame buffer table file etcfbtab without entry ownership console device properly set info fbtab add umask etcrc login prevent key file created startup root operation created world writeable note may want set umask login instead info umask rc chmod gow etc chmod gw etcdumpdates none file etc require write access world except dumpdate requires group write access info chmod alias state utmp v remote rmtab edit etcrclocal comment change part chmod motd etcmotd normal system message day wont allow people gain root access could nuisance change anonymously additionally important ensure line  rm f tmpt  begining part chmod u following file unless specifically use changing mode file using help prevent would cracker exploiting unknown security flaw file could used compromise system usrbincu usrbintip usrbinfusage usrbinnsquery usrbinuucp usrbinuuname usrbinuustat usrbinuux usrucbrcp usrucbrdist usrucbrlogin usrlibuucpuusched usrlibuucpuuxqt usrucbrshusrlibuucpuucico usrgameshack usrgameschesstool usrgamesfortune usrlibexrecover usrgamesrobots usrlibuucpremoteunknown usrgameshack usrgamessnakeusrbinsunviewsvrelease usretcrfsetup usrbinallocate used c security usrucbquota used disk quota usrlibexpreserve used recover edit session died following may needed run user root would need suid root usretcshutdown usrlibacctaccton info lot man page chmod g following file unless specifically use changing mode file using help prevent would cracker exploiting unknown security flaw file could used compromise system usrbinwall usretctrptusrbinsunviewtoolplaces usrbiniostat usrbinipcs usrucbvmstat usrucbnetstat usretcarp usretcdmesg usretcdkinfo usretcchill usretcdumpfs usretcdevinfo usretcnfsstat usroldperfmon openwinbinxload usrkvmpstat usrkvmcrash usrkvmgetcons usretckgmon usretctrpt info lot man page edit syslogconf  uncomment auth mail line enables improved loging logins su prepared lot data info syslogconf chmod vmunix chgrp kmem vmunix prevent cracker finding kernel configuration change id management    disable suid passwd using ni f option binpasswd two option exist using ni user database nt need binpasswd two hard link binchfn binchsh suid root local entry etcpasswd would like able change thier passwd please note binpasswd race condition exploited write file root allowing cracker gain root access either case yppasswd ypchfn ypchsh need suid root case cd bin chmod u yppasswd ypchfn ypchsh option cd bin chmod u passwd chfn chsh option replace passwd proactive check bad passwds passwd program ref option b binary edit passwd sun code shown cd bin cp passwd passwdold chmod passwdold adb w passwd core file passwd l f xde address required following step xdew xde xa x ctrld chmod binpasswd note following file contain code suid root unless chmod u done intend use ensure link modified file binpasswd yppasswd ypchfn ypchsh chfn chsh info ref lgm advisoryunixpasswdmaynewfix remove id sync id created enable admin sync file system system crash default without password abused gain access system simplest solution live without feature remove id info passwd implement shadowing restrict access user encrypted password even though password encrypted crack publicly available program used effectively guess user password done two different way  implementing sun c security package provides additional auditing found auditing troublesome maintain nt need extensive data  second option implement shadowing c procedure fully explained detail ref short ensure patch installed note also implement securenets ni split etcpasswd etcpasswd etcsecuritypasswdadjunct split etcgroup etcgroup etcsecuritygroupadjunct add required audit user even implementing auditing comment part rclocal start audit reboot existence file etcsecuritypasswdadjunct several effect rclocal improve system security ypbind rpcmountd without n info ref ensure id passwd id without password provides open access system root come without password info passwd modify mail system   sendmail program notorious numerous bug gave cracker root access illegitimately huge topic paper book claim expertise great fortune sendmail experience limited several different possible configuration option outline point reference host configuration intend send receive mail directly machine option live sendmail install newest version  currently  ensure mail file always existence user ref  chmod u binmail  change sendmail use  procmail  maillocal ref refwhere get change sendmail default uid sendmailcf  ou  turn security feature sendmail  opauthwarnings needmailhelo noexpn novrfy restrictmailq  ref cheswick bellovin costales b install zmailer  ref url zmailer package zmailer use binmail chmod u binmail mail host received different host ie local mail delivery handled another host system need support outgoing mail prevent sendmail daemon started comment part etcrclocal start sendmail outgoing mail install latest version sendmail see config thing change sendmail config since mail delivery handled main mail host need binmail chmod u binmail b install zmailer  ref url zmailer package zmailer use binmail chmod u binmail need mail whatsoever machine incoming outgoing internal certainly secure mode email able sent machine basic restriction outside access prevent abuse access disable mail totally chmod u usrlibsendmail usrlibsendmailmx binmail comment part rclocal start sendmail package enable better monitoring security             tripwire ref include suid sgid file config modified cop script check every run awaiting response dan farmer mind releasing script tcp wrapper ref cop ref set run night careful check bitbucket output ensure working properly modified portmapper login rshd rlogind pidentd w venema ref tamu tiger script ref note australian group sert put together package called megapatch includes several package well many patch sunos previously mentioned ref reference      dan farmer wietse venema  improving security site breaking  url ftpwintuenl pubsecurityadminguidetocrackingz w cheswick bellovin  firewall internet security  addison wesley april h stern  managing nfs ni  oreilly associate april wietse venema  tcp wrapper network monitoring access control booby trap  proceeding third usenix unix security symposium pg  url ftpwintuenl pubsecuritytcpwrapperpsz paper txtz avail url ftpwintuenl pubsecuritytcpwrapperssharz package eric oliver  shadow without c auditing  june url ftphawaiiedu lgm advisoryunixpasswdmaynewfix proactive password changing program several one url available url infomcsanlgov pubsystemsanlpasswdtarz zmailer package url cstorontoedu pubzmailertarz pubzmailerreadme bryan costales eric allman neil rickert  sendmail  oreilly associate june lgm advisory avaiable though lgm file server lgmfileserver bagpussdemoncouk lgm advisoryunixmailjan lgm advisoryunixmailjanpatch lgm advisoryunixmailmay tripwire gene kim gene spafford url ftpcspurdueedu pubspafcoasttripwire cop dan farmer gene spafford url ftpcertorg pubtoolscops portmapper login rshd rlogind wietse venema url ftpwintuenl pubsecurityportmapsharz url ftpwintuenl pubsecuritylogdaemonxxtarz tamu tiger script safford et al url nettamuedupubsecuritytamu local mail delivery agent url ftpinformatikrwthaachende pubpackagesprocmail url ftp   maillocal joerg czeranski megapatch sert url ftpserteduau securityserttoolsmegapatchtarz source routinng patch url ftpgreatcirclecom pubfirewallsdigestvnz acknowledgement thanks people compsecurityunix offered suggestion thanks following people kind review casper fwiuvanl casper dik baron uhunixuhcchawaiiedu baron k fujimoto rgoodman uhunixuhcchawaiiedu becky goodman newsham uhunixuhcchawaiiedu tim newsham andys unipalmcouk andy smith    thought future development  nt enough time well like disable routed standard routing table prevents receiving false routing table remove devnit customizing ruserok bit beyond basic info source license  modify routine ruserok return  case wish disallow disable rhosts authentication entirely simply routine return  look file usrlibshlibetcreadme modify libcso note also make following change file usrlibshlibetcreadme line mv rpccommondata rpccommondatao insert mv xccsmultibyte xccsmultibyteo makefile change line read objsortusrlibshlibetcobjsort awkfileusrlibshlibetcawkfile add ldl option end ld command line info ruserok hostsequiv source code file liblibcnetrcmdc ref ref  tmk                                    tom kroeger pray wind university hawaii computing center pray wave mall keller hall  pray day honolulu hi   email tmk uhunixuhcchawaiiedu     shamel maishydroqcca thu jun  edt article compsyssunadmin newsgroups compsyssunadmin compsyssunapps compsyssunwanted path babbageeceucedu newskeicom uhogmitedu europaenggtefsdcom howlandrestonansnet spoolmuedu torn utnut utcsri newsflashconcordiaca sifon clousocrimca hobbitireqhydroqcca shamel shamel maishydroqcca stephane hamel subject system administration tool messageid csnici ireqhydroqcca followupto compsyssunadmin compsyssunapps compsyssunwanted sender news ireqhydroqcca netnews admin organization hydroquebec montreal canada xnewsreader tin version  pl reference csic csfbfirfbccom date thu jun  gmt line xref babbageeceucedu compsyssunadmin compsyssunapps compsyssunwanted since topic often come around make draft copy extensive document writting available ftp postscript format warned still early stage probably contains lot bad english formulation mother language french  still valuable piece information course open comment suggestion extension information contained document entitled  management monitoring tool distributed heterogeneous clientserver environment  available ftp coltmaishydroqcca  incomingmanmonps          oooo oooo      stephane hamel technical advisorsystem admin hydroquebectdsb sherbrooke west nd floor montreal qc canada hc phone  fax  email shamel maishydroqcca                   