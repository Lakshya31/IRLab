ncsc technical report volume  library foreward report second five companion document trusted database management system interpretation trusted computer system evaluation criterion companion document address topic important design development secure database management system written database vendor system designer evaluator researcher report address entity referential integrity issue multilevel secure database management system acknowledgment national computer security center extends special recognition author document initial version written vinti doshi sushil jajodia mitre corporation final version written bill wilson stan wisseman arca system inc document series produced guidance shawn p obrien national security agency louanna notargiacomo barbara blaustein mitre corporation david wichers arca system inc wish thank member information security community enthusiastically gave time technical expertise reviewing document providing valuable comment suggestion table content section page  introduction  background purpose  scope  introduction entity referential integrity  audience document  organization document  background  basic concept entity referential integrity  referential integrity rule  delete  update referenced relation  nsert update referencing relation  additional rule  problem referential integrity constraint  entity referential integrity ml database  related tcsec requirement  basic concept multilevel relation  concept primary key multilevel relation  entity integrity multilevel relation  referential integrity multilevel relation  enforcement integrity constraint  covert channel  primary key uniqueness  enforcement referential integrity rule  enforcement integrity rule c fk c pk  enforcement integrity rule c fk c pk  relation dbms architecture  summary reference list figure figure page  relation sod  relation p  referential constraint relation pr p sod  relation sod p starship  apollo  deleted cascadesdelete rule  relation sod p starship  apollo  deleted nullifiesdelete rule  relation sod p starship  enterprise  updated value  us enterprise  cascadesupdate rule  relation sod p starship  enterprise  updated value  us enterprise  nullifiesupdate rule  different sod view based access class  typical relation instance sod p  unclassified instance p sod relation  sod insertion tuple corresponding starship  voyager  unclassified user  relation p sod c fk c pk  relation sod p without polyinstantiation  relation tuplelevel granularity  relation attributelevel granularity list table table page  summary covert channel referential integrity rule section introduction document second volume series companion document trusted database management system interpretation trusted computer system evaluation criterion tdi dod document examines entity referential integrity issue multilevel secure ml database management system summarizes research date area  background purpose national computer security center published trusted database management system interpretation tdi trusted computer system evaluation criterion tcsec tdi however address many topic important design development secure database management system dbms topic inference aggregation database integrity addressed ongoing research development since specific technique topic area yet gained broad acceptance topic considered inappropriate inclusion tdi tdi supplemented series companion document address issue specific secure dbms companion document focus one topic describing problem discussing issue summarizing research done date intent series make clear dbms vendor system designer evaluator researcher issue current approach pro con relate tcsectdi evaluation specific area require additional research although guidance may presented nothing contained within document interpreted criterion document assume reader understands basic dbms concept relational database terminology security background sufficient use tdi tcsec also assumed however fundamental discussed whenever common understanding important discussion  scope document address entity referential integrity issue multilevel secure dbms second five volume series tdi companion document includes following document  inference aggregation issue secure database management system inference  entity referential integrity issue multilevel secure database management system  polyinstantiation issue multilevel secure database management system poly  auditing issue secure database management system audit  discretionary access control issue high assurance secure database management system dac series document us terminology relational model provide common basis understanding concept presented topic covered series concept presented apply database modeling paradigm depending specific model entity referential integrity constraint discussed document however important difference different model primary key relational dbms represent unique identifier tuples value attribute tuple must protected accordance sensitivity data represent interfere role unique identifier tuples contrast object identifier oid objectoriented dbms property attribute object identifies represent uservisible data value khoshafian copeland provide useful taxonomy different way specifying object identity including technique used relational object oriented dbms khoshafian similarly relational dbms foreign key represent data value serve pointer tuples objectoriented dbms pointer object used store data value rather represent inclusion one object within another relational database problem may occur reference deleted reference remain object implication distinction enforcement secrecy objectoriented dbms require research document specifically address relational dbms document related companion document inference aggregation issue secure database management system polyinstantiation issue multilevel secure database management system much discussion relationship enforcement integrity constraint multilevel security center potential inference channel integrity constraint introduce one way avoid channel entity integrity use polyinstantiation discussed later detail  introduction entity referential integrity secrecy integrity two key concept community database security researcher user secrecy refers protection safety data unauthorized disclosure integrity refers unauthorized alteration destruction data wider database research community integrity refers generally correctness accuracy internal consistency data preserving accuracy information extremely important rn database relational model one way accuracy information preserved preventing update violate integrity constraint entity integrity referential integrity two important integrity constraint defined relation enforced dbms entity integrity state primary key attribute relation allowed null value addition primary key must unique value property primary key correspond fact entity real world distinguishable ie unique identification kind relational model primary key performs function unique identification referential integrity interrelation integrity constraint general referential integrity defines existence relationship entity database need maintained dbms document defines integrity constraint formally present importance context security detail multilevel application data classified control disclosure important realize necessary tradeoff made secrecy integrity challenge enforcing integrity constraint across multiple secrecy level without disclosure information document defines entity referential integrity standard relational dbms present method resolving inherent integritysecrecy conflict ml environment  audience document document targeted four primary audience security research community database application developerssystem integrator trusted product vendor product evaluator general document intended present framework understanding nature entity referential integrity policy requirement conflict need enforce access control policy framework used describe research done date approach present providing solution specific audience expect get following document researcher document describes basic problem simultaneously enforcing integrity constraint mac important research contribution discussed various topic covered related research aspect integrity relationship secrecy discussed section  additional relevant work researcher consult two companion document inference aggregation issue secure database management system inference polyinstantiation issue multilevel secure database management system poly database application developersystem integrator document describes various entity referential integrity facility could provided ml dbms discus implication facility relative tradeoff involved meeting system requirement secrecy integrity trusted product vendor document describes conflict mandatory access control mac multilevel entity referential integrity constraint discus approach entity referential integrity enforcement ml database benefit drawback approach particular considers issue enforcement entity referential integrity constraint ml database relate tcsec access control covert channel requirement discussed context tuple level well element level labeling document provide framework understanding specific requirement interpretation developed national computer security center evaluator document describes access control covert channel issue related entity referential integrity provides framework analyzing specific vendor mechanism understanding technical review boardinterpretations working group decision  organization document organization remainder document follows  section give definition entity referential integrity respect singlelevel dbms describes various important concept related referential integrity  section defines basic concept entity referential integrity respect multilevel relation  section discus issue associated covert channel related enforcing entity referential integrity constraint  section present conclusion section background entity integrity referential integrity two basic integrity requirement relational dbms rdbms help prevent incorrect data entered database entity integrity guarantee unique representation entity database specification primary key attribute relation referential integrity assures reference exist two entity related entity exist database referential integrity place restriction foreign key attribute referential integrity one important interrelation integrity constraint relational data model although basic concept discussed past ten year successful referential integrity capability rdbms still challenging implementation problem referential integrity appears simple concept operational definition appear literature imprecise lead host anomaly standard relational database perceived user collection relation relation welldefined mathematical property used store data relation two part stateinvariant relation schema r  ai attribute domain di   n set acceptable value ai statedependent relation r r set distinct tuples form  element ai value domain di   n following notation convention used throughout document definition relation scheme denoted bold font r r r corresponding relation denoted using plain font r r r however clear specific example symbol used denote relation schema well corresponding relation let x denote one attribute relation r tuple relation r x denotes projection onto x section first defines entity referential integrity followed terminology related concept example make use structured query language sql syntax ansi section give various rule enforcing referential integrity discus problem associated referential integrity singlelevel relational database understanding integrity better discus conflict enforcement mac policy section  basic concept entity referential integrity defining entity integrity necessary define concept primary key simple term primary key relation unique identifier tuple relation precisely primary key relation r set attribute pk following property value pk uniquely identifies tuple relation r state r tuples pk pk pk minimal proper subset pk satisfying property possible one set attribute satisfying property set called candidate key precisely one candidate must chosen designated primary key r example consider relation schema sod starship objective destination contains starship name starship purpose flight objective destination destination example relation relation schema sod given figure  starship objective destination enterprise exploration talos voyager spying mar apollo exploration moon saratoga mining moon figure  relation sod since attribute starship uniquely identifies tuple relation sod candidate key relation sod starship candidate key relation sod also primary key relation sod sql syntax attribute constituting primary key specified relation schema created following show create table sod starship char null objective char destination char primary key starship notice ansi syntax us term  table  instead term  relation  used document entity integrity constraint requires attribute value primary key defined tuple entity integrity pk primary key relation r state r every tuple r every attribute pk null foreign key provides basis tuple refer another tuple let r r two relation schema let r r denote respective relation corresponding schema referential integrity let pk denote primary key r let fk denote one attribute relational schema r fk said foreign key r referencing r given tuple r following two requirement met  fk either wholly null wholly nonnull whenever fx nonnull tuple r fk pk r referencing relation r referenced relation sometimes pk referred target value foreign key fk notice r r need distinct example addition relation schema sod given example consider relation schema p personname starship contains name employee personname name ship assigned employee starship example relation p given figure  suppose personname uniquely identifies employee p relation personname becomes primary key relation schema p starship declared foreign key p relation schema sod referenced relation dbms support referential integrity automatically ensure whenever employee assigned nonnull ship matching tuple relation schema sod identical value attribute starship notice employee mr spock given figure  assigned starship seems definition p relation null allowed application may desirable prohibit situation ie every employee must assigned starship referencing relation schema definition specify whether foreign key attribute assume null value using sql syntax foreign key specified follows create table p personname char null starship char primary key personname foreign key starship reference sod starship personname starship james kirk enterprise mr spock null tim mckelley apollo figure  relation p follows definition foreign key identical matching primary key value referenced relation every foreign key value referencing relation important maintain integrity referencing value foreign key value referenced value primary key value example consider relation schema pr personname rank contains employee name personname rank employee rank personname primary key relation schema personname also foreign key referring relation schema p relation schema pr expressed sql follows create table pr personname char null rank char primary key personname foreign key personname reference p person name relation schema pr reference relation schema p given example addition relation schema p example reference relation schema sod since referential constraint pr p also p sod relation schema p becomes referencing relation referenced relation see figure  figure  referential constraint relation pr p sod depicted referential path pr sod follows pr p sod referential cycle closed referential path referential path point back starting relation referred referential cycle general referential cycle including n relation n represented follows date rn rn rn  r r rn referential cycle interest since cause insertion problem presence referential cycle necessary one following constraint true otherwise impossible insert first tuple relation one foreign key referential cycle must allowed null value constraint check done endoftransaction ie transaction commits selfreferencing relation special case referential cycle includes exactly one relation relation multiple foreign key corresponding different relation important concept related term defined section summarized follows  primary key relation null value tuple within relation entity integrity primary key must unique property primary key  foreign key null value example figure  employee mr spock assigned starship yet therefore starship value mr spock null note specific instance desired prohibit null value foreign key done using null clause attribute foreign key relation created  referential integrity every nonnull value foreign key must matched identical primary key value referenced relation converse need true example starship saratoga figure  employee assigned figure   relation referenced relation well referencing relation  referential integrity rule whenever two relation related referential constraint necessary reference kept consistent face insertion deletion update relation date identifies several action taken maintain consistency reference date exactly action chosen particular relation depends behavior desired underlying application possible action discussed following subsection  delete target foreign key deleted could result dangling reference action needed make sure happen four option may specified referenced relation restricteddelete cascadesdelete nullifiesdelete set defaliltdelete explained turn restricteddelete restricteddelete option specified primary key value referenced relation deleted long exists least one matching foreign key value referencing relation deletion referenced value restricted case corresponding referencing value referencing relation instance suppose attempt made delete starship apollo relation sod since referencing relation p refers relation sod attribute starship restricteddelete rule deletion performed tuple p referencing starship apollo delete denied two relation would remain unchanged syntax specifying restricteddelete rule may given follows create table p personname char null starship char primary key personname foreign key starship reference sod starship delete restrict cascadesdelete cascadesdelete option whenever target tuple foreign key deleted referencing foreign key tuples also deleted previous example attempt made delete starship apollo relation sod delete would cascaded relation p employee tuples referencing starship apollo would also deleted cascadesdelete operation relation sod pd would change form given figure  sod starship objective destination enterprise exploration talos voyager spying mar saratoga mining rigel p personname starship james kirk enterprise mr spock null figure  relation sod p starship  apollo  deleted cascadesdelete rule sql cascadesdelete rule specified follows create table p personname char null starship char primary key personname foreign key starship reference sod starship delete cascade nullifiesdelete whenever nullifiesdelete option specified foreign key referencing foreign key attribute value set null value tuple containing referenced value deleted example given earlier starship apollo deleted foreign key value tuples referencing apollo relation p set null new state relation shown figure  sod starship objective destination enterprise exploration talos voyager spying mar saratoga mining rigel p personname starship james kirk enterprise mr spock null tim mckelley null figure  relation sod p starship  apollo  deleted nullifiesdelete rule setting referencing value null important make sure relation schema allows null value foreign key attribute otherwise conflict nullifiesdelete rule expressed sql follows create table p personname char null starship char primary key personname foreign key starship reference sod starship delete set null set defaultdelete sql ansi sql ansi standard provide yet another referential action delete operation called set default option similar nullifies delete rule given difference set default option contains default clause specifies default value attribute default value may null nonnull value referential action specifies set default option referencing attribute defined implicit explicit default clause default value null set default equivalent set null sql syntax set defaultdelete rule follows create table p personname char null starship char primary key personname foreign key starship reference sod starship delete set default option default option specified option field  update referenced relation changing primary key value referenced relation could violate referential integrity unless appropriate action taken different option specified referencing relation whenever update made target primary key value referenced relation possible option restrictedupdate cascadesupdate nullifiesupdate set defaultupdate restrictedupdate restrictedupdate option update target primary key value referenced relation made long exists least one matching foreign key value referencing relation update referenced tuple restricted case matching referencing tuples example suppose attempt made update name starship enterprise us enterprise relation sod shown figure  employee assigned ship update rejected relation sod p remain unchanged look like figure   syntax specifying restrictedupdate option may specified follows create table p personname char null starship char primary key personname foreign key starship reference sod starship update restrict cascadesupdate cascadesupdate option specified referencing relation whenever update made referenced attribute change cascaded matching referencing attribute mean whenever target value foreign key modified referencing foreign key value also similarly modified consider example attempt made update name starship enterprise us enterprise relation schema sod cascadeupdate update cascaded matching referencing tuples relation schema p employee assigned starship enterprise name updated us enterprise new state two relation sod p shown figure  sql cascadeupdate option expressed follows create table p personname char null starship char primary key personname foreign key starship reference sod starship update cascade sod starship objective destination us enterprise exploration talos voyager spying mar apollo exploration moon saratoga mining rigel p personname starship james kirk us enterprise mr spock null tim mckelley apollo figure  relation sod p starship  enterprise  updated value  us enterprise  cascadesupdate rule nullifiesupdate nullifiesupdate option referencing foreign key attribute value set null whenever target primary key value referenced relation updated example given earlier name starship updated enterprise us enterprise starship employee assigned enterprise set null new state relation shown figure  setting referencing value null important make sure schema definition allows null value foreign key attribute null rule allow null value conflict two integrity rule nullifiesupdate rule expressed sql syntax follows create table p personname char null starship char primary key personname foreign key starship reference sod starship update set null sod starship objective destination us enterprise exploration talos voyager spying mar apollo exploration moon saratoga mining rigel p personname starship james kirk null mr spock null tim mckelley apollo figure  relation sod p starship  enterprise  updated value  us enterprise  nullifies update rule set defaultupdate sql sql define another referential constraint update set default referential constraint specifies set default option referencing attribute defined implicit explicit default clause default clause specifies default value attribute default value may null nonnull value default value null set default option considered equivalent nullifies update rule sql syntax set defaultupdate rule follows create table p personname char null starship char primary key personname foreign key starship reference sod starship update set default option default option specified option field  insert update referencing relation tuple inserted relation foreign key tuple relation updated insertion update foreign key value accordance referential integrity foreign key value must null identical matching primary key value referenced relation requirement enforced disallowing insert update unless condition met setting foreign key default value null null allowed condition met  additional rule spite many integrity rule discussed section rule exhaustive additional option include conversation end user transferring information file instance additional option sql pendant specification implies primary key value referenced relation foreign key value referencing relation example referential constraint relation emp shown soon last employee particular department deleted department also deleted foreign key starship reference pendant sod starship  problem referential integrity constraint referential integrity play major role rdbmss employed express existence dependency concept referential integrity seems simple topic discussion past several year markowitz horowitz operational definition precise therefore lead anomaly confusion surround concept implementation rdbmss need carefully examine data manipulation problem caused certain referential integrity structure find way avoid problem rdbms single update delete affect multiple tuples application referential integrity rule eg cascading deletes update necessary process deterministic word final state database function initial state database specific statement executed time certain referential constraint associated relation may block update deletion tuples conflicting referential constraint specification thus making outcome update delete statement unpredictable problem identified dependency order referential integrity constraint applied referential cycle dependency order tuples processed response query discussion problem detail outside scope document section entity referential integrity ml database entity referential integrity defined multilevel relation necessary extend basic concept classical singlelevel relation multilevel context ml database data assigned different security level user assigned clearance level user access data cleared based user security clearance consequence meaning relation becomes complicated multilevel world clear consensus regarding exact definition multilevel relational model develop ml database necessary define security policy develop mechanism support policy get necessary assurance system developed secure section first review basic concept multilevel relational data model defines entity referential integrity constraint multilevel relation  related tcsec requirement tcsec imposes two type requirement affect entity referential integrity enforced dbms targeted meet tcsec requirement b dbms targeted class b must enforce mac policy subject storage object control place requirement sensitivity label element primary foreign key relationship sensitivity level foreign key primary key reference dbms targeted class b tcsec requires thorough search covert channel storage channel class b multilevel context enforcement uniqueness primary key enforcement referential integrity create significant covert channel guideline acceptable bandwidth covert channel given section tcsec section specifically address implication direct enforcement mac control required b implication integrity enforcement covert channel covered section determination precisely approach enforcing entity referential integrity considered compliant tcsec requirement evolve time evaluation community publishes official interpretation subject however successful evaluation trusted oracle dbms mac mode unmodified integrity mechanism precedence set class b dbms oracle  basic concept multilevel relation basic model multilevel relation need defined mac policy mind mac policy ml database often based belllapadula model bell stated term subject object subject active entity process request access object whereas object passive entity record file field within record every subject assigned clearance level every object classification level classification level clearance collectively referred security level form lattice security level two component hierarchical component set possibly empty unordered category security level c said dominate security level c partial order hierarchical component c greater equal c category c included c security level c strictly dominates security level c partial order c dominates c c equal c following two necessary condition belllapadula model bell dod simple security condition  read ups  subject read object security level dominated subject level property star property  write down  subject write object security level dominates subject level apply concept dbms necessary determine granularity object protected mac ie storage object security level associated storage object work ml database focused four choice assigning security level data stored relation one assign security level entire relation individual tuples row relation individual attribute column relation individual element relation definition general case considered security level assigned individual data element stored relation however since tuple level labeling used dbms product evaluated date concept also considered simplified context tuple level labeling relation schema multilevel context contains data attribute also includes corresponding security level data attribute formal definition multilevel relation schema multilevel relation follows denning relation schema multilevel relation schema following form r c c  cn ai data attribute domain di ci classification attribute ai domain ci  n set consisting security level tuple level labeling used one classification attribute entire tuple r  c multilevel logical relation schema r corresponding relation rc per security level security lattice user clearance security level c see relation rc contains data security level c formally relation relation security level c following form rc c c  cn rc consists set tuples form c   cn ai lie domain di ai null c ci ci  n even ai null classification attribute ci never null attribute value ai null two reasonable possibility corresponding security level value ci could assigned value identical c security level attribute constituting primary key document ci would assigned value consistent second possibility security level primary key value dominated c tuple tuple shown rc security level primary key value dominated c tuple shown rc however attribute value security level dominated c shown null value corresponding security level primary key value tuple level labeling rc consists tuples whose security level dominated c concept better explained help example taken jajodia example consider relation schema sod given example starship primary key relation schema sod security level assigned granularity individual data element hierarchical order usually followed top secret t secret confidential c unclassified u user secret clearance see entire multilevel relation sod user unclassified clearance see unclassified instance sodu shown figure  sod starship objective destination enterprise u exploration u talos u voyager u spying mar sodu starship objective destination enterprise u exploration talos u voyager u null null u figure  different sod view based access class  concept primary key multilevel relation notion primary key fundamental concept world singlelevel relational database primary key used maintain integrity relation used database design also used storage retrieval purpose primary key singlelevel relation must satisfy uniqueness property minimality property discussed section  entity integrity requires primary key serf unique identifier tuple relation contain null value uniqueness property create covert channel discussed section one approach avoiding channel involves augmenting userdefined primary key security level attribute associated primary key attribute however remainder document assumed userspecified primary key consisting subset data attribute including security level denning called apparent primary key multilevel relation schema  entity integrity multilevel relation relation schema r assumed userdefined apparent primary key consisting one data attribute r denoted pk entity integrity property standard relational model extended multilevel environment defining three requirement given applicable element level classification denning three requirement automatically met tuple level classification first requirement standard relational model tuple rc null value attribute pk second requirement state pk value uniformly classified otherwise pk value would wholly nonnull wholly null security level third requirement state security level value attribute pk must dominate security level pk attribute otherwise could instance nonnull attribute would associated null primary key viewed level primary key three requirement formally defined follows multilevel relation schema r said satisfy entity integrity relation instance rc r tuple  rc ai  pk ai ùnull ai aj  px ci cj ie pk said uniformly classified ai  pk ci c pk c pk classification apparent primary key pk  referential integrity multilevel relation discussed previous section nonnull foreign key value referencing relation always matching primary key value referenced relation ml database requirement implication relationship among security level attribute foreign key security level referenced primary key addition possible action could taken enforce referential integrity update deletion introduce covert channel discussed section relation schema following example used illustrate different situation security conflict may occur example consider multilevel relation schema p given example personname apparent primary key relation schema p starship foreign key p refers relation schema sod typical relation instance sod p given figure  note example schema attribute name part primary key foreign key respective security level part key therefore tuples security level foreign key relation p higher lower security level corresponding primary key relation sod example includes tuples explain conflict arising security level different level sod starship objective destination enterprise u exploration u talos u voyager u spying mar apollo spying moon p personname starship james kirk u enterprise u mr spock u voyager tim mckelley u apollo u figure  typical relation instance sod p recall definition referential integrity standard relational database referential integrity fk foreign key r referencing r pk primary key r tuple instance r r tuple instance r r  fk either wholly null wholly nonnull whenever fk nonnull tuple r fk pk ml database need property true database seen security level assume tl fk wholly null viewed security level first requirement say must wholly nonnull attribute value making fk security level would security level attribute value fk would null others nonnull since allowed attribute value fk must security level attribute value fk null convention assigned security level argument give u first rule referential integrity rule foreign key referencing relation must uniformly classified ie attribute value make foreign key must assigned identical security level rule automatically satisfied tuple level labeling second part referential integrity requires foreign key fk null matching primary key pk referenced relation r true database seen security level fk matching pk must visible security level fk hence security level fk must dominate security level matching primary key pk give u second rule referential integrity rule security level foreign key must dominate security level primary key referenced tuple ie c fk c pk tuple level labeling rule reduces requirement security level referenced tuple must dominated security level referencing tuple p personname starship james kirk u enterprise u mr spock u null u tim mckelley u apollo u sod starship objective destination enterprise u exploration u talos u voyager u null u null u figure  unclassified instance p sod relation example consider relation sod p shown figure  unclassified user see two relation given figure  unclassified user referential integrity property violated starship  apollo  visible unclassified user unclassified user point view either starship  apollo  exist referential integrity error reference classified starship displayed user security error  enforcement integrity constraint research work topic covered document either focused polyinstantiation mechanism deal primary key requirement entity integrity dealt broader question inference meadow early work conflict integrity security mainly considered approach maximizing integrity eliminating inference channel meadow polyinstantiation inference research covered appropriate tdi companion document however several work dealing aspect database integrity go beyond entity referential integrity fit area notargiacomo wiseman explored separation duty approach protect data unauthorized modification within ml database notargiacomo wiseman concept applying separation duty integrity enforcement ensure modification state made sufficient people agree properly reflects real world requirement fact certain user unlikely collude particular change underlying assumption indicated way role assigned user notargiacomo explores issue integrating interpretation clarkwilson integrity model clark multilevel dbms security policy preliminary investigation raised issue object granularity interaction mac dac integrity policy application clarkwilson type control class user need nested transaction wiseman see high level abstract view separation duty several people agreeing change state integrity encouraged enforcing constraint ensure state always valid subjecting input separation duty reind van de reit beukering describe constraint involving integrity security specified moxum active objectoriented knowledgebase system van de reit premise change database governed rule form integrity constraint security check case integrity constraint refer quality data security constraint refer protection access right kind constraint specified mokum prolog predicate separated time manipulation object collection mentioned constraint performed createchangeinspectdestroy check performed prolog script regulate access object collection enforce integrity constraint trigger implies need extend trusted computing base include prolog compiler problematic respect assurance addition considering entity referential integrity conflict security maimone allen provide alternative resolving problem arise maintaining transaction integrity value constraint maimone security conflict transaction integrity may arise single transaction designed step must perform write operation different security level value constraint defined integrity rule may restrict valid value data element conflict arises existing data classified label user activating constraint meet constraint defined object creation make distinction use trigger constraint enforcing integrity rule utility declarative constraint including primary foreign key value domain constraint constraint declares invariant property detailing meaning consistent state mark jajodia jajodia developed technique enforce certain integrity constraint minimize amount sensitive information disclosed transform multilevel constraint constraint enforced individual level approximate enforcement multilevel constraint section covert channel b higher mac requirement tcsec specify ml system must additionally guard indirect access information flow recognized covert channel exist system tcsec provides guideline action must taken channel depending bandwidth channel enforcement integrity constraint create covert channel channel discussed section interpretation indicating precisely channel deemed acceptable system evaluated various tcsec level developed evaluation community deal specific vendor implementation  primary key uniqueness problem arise multilevel relation user lower security level try enter tuple primary key value existing tuple higher security level user try update primary key attribute value already exists higher level insert update allowed primary key uniqueness preserved hand user allowed insert primary key value exists covert channel following example provides concrete illustration example consider multilevel relation schema sod example section  actual relation secret instance shown figure  suppose unclassified user see unclassified instance figure  attempt update missing value second tuple corresponding starship  voyager  user allowed update two tuples corresponding primary key value starship  voyager  secret instance leading violation primary key constraint shown figure  unclassified user attempt rejected channel since unacceptable way must found deal existence tuples secret instance starship objective destination enterprise u exploration u talos u voyager u spying mar voyager u exploration u moon u figure  sod insertion tuple corresponding starship  voyager  unclassified user since user infer secret tuple exists primary key user attempting insert channel viewed example inference however also represents covert channel secret process insert delete tuples given primary key action could detected unclassified user avoid channel secret tuple unclassified tuple starship  voyager  must somehow coexist instance secret level security consideration led notion polyinstantiation denning polyinstantiation force relation contain multiple tuples primary key distinguishable classification level nonprimary key attribute relation lunt user designated primary key must augmented classification level maintain primary key uniqueness polyinstantiated database used denning  term apparent primary key userspecified primary key jajodia contends use polyinstantiation cover story need confined case intended since uncontrolled use polyinstantiation lead loss integrity confusion semantics relational data model jajodia debate continues whether polyinstantiation needed multilevel relation sandhu polyinstantiation required multilevel relation must solution close channel polyinstantiation used question polyinstantiation managed burn maintains result fundamental conflict enforcing confidentiality secrecy information ml database integrity dbms product expanded include ability correct error inconsistency introduced polyinstantiation burn thorough discussion issue associated polyinstantiation beyond scope document covered another volume series polyinstantiation issue multilevel secure database management system poly purpose document discussion polyinstantiation confined impact referential integrity  enforcement referential integrity rule section showed referential integrity ml database security level foreign key must dominate security level primary key referenced tuple c fk c px requirement guarantee referenced primary key visible user see foreign key nonnull however situation somewhat complicated referenced relation polyinstantiated event may one tuple apparent primary key matching fk method must used uniquely consistently determine primary key considered referenced primary key one approach augment fk security level attribute tuple security level tuple level labeling used approach used matching pk security level fx requirement relationship security level pk fk becomes c fk c pk enforcement referential integrity rule described section  result covert channel channel discussed discussion divided two permitted case c fk c pk c fk c pk  enforcement integrity rule c fk c pk study enforcement integrity rule security level referencing tuple security level referenced tuple need look case four different level granularity multilevel relation relation relation level labeling tuple level labeling integrity rule usable without modification case considered equivalent relationship occurring singlelevel database attribute element level labeling potential channel cascadfsdelete rule rule enforced without problem channel better explained help example example consider two relation sod p given figure  security level foreign key relation p example security level referenced primary key relation sod second tuple relation p unclassified user oily see attribute personname user cleared see value starship tuple also user see corresponding referenced tuple relation sod suppose confidential user come attempt delete second tuple relation sod starship  saratoga  delete rule specified cascadesdelete referencing tuple p also deleted unclassified user see attribute value personname  mr spock  cause channel p personname starship james kirk u enterprise u mr spock u saratoga c sod starship objective destination enterprise u exploration c talos c saratoga c mining c rigel c figure  relation p sod c fk c pk channel case avoided equivalence security level foreign key referenced primary key extended security level entire referencing tuple security level entire referenced tuple violation occur enforcing insert delete update rule fact acknowledged seaview model lunt referential secrecy model given burn burn b burn also suggests selective enforcement referential integrity case security level referencing relation referenced relation assuming channel either monitored deemed cause serious threat  enforcement integrity rule c fk c pk final case considered security level referencing tuple dominates security level referenced tuple integrity rule insert delete update considered individually effect dominance referencing tuple security level referenced tuple investigated effect different level labeling granularity multilevel relation upon enforcement integrity also considered throughout discussion assume either relation polyinstantiated consistent method employed determine unique primary key referred foreign key elementlevel granularity integrity rule insert delete update examined individually relation elementlevel granularity condition violating security constraint investigated delete rule discussed section  four delete rule referential integrity singlelevel relation follows restricteddelete rule ii cascadesdelete rule iii nullifiesdelete rule iv setdefaultdelete rule rule considered turn applicability multilevel relation labeled element level restricteddelete rule restricteddelete rule state referenced primary key tuple deleted long corresponding referencing tuple somewhere database instance consider relation sod p given figure  relation p security level foreign key value starship  voyager  dominates security level primary key value relation sod according restricteddelete rule long tuple foreign key value  voyager  p tuple primary key value  voyager  deleted relation sod give rise channel downward flow information highlevel referencing foreign key lowlevel subject attempting delete tuple containing primary key therefore restricteddelete rule violates secrecy security level foreign key dominates security level primary key referenced tuple ii cascadesdelete rule delete rule specified cascadesdelete rule tuple sod starship  voyager  deleted unclassified level tuple p starship  voyager  secret level also deleted relation instance p given figure  personname  mr spock  unclassified level tuple containing starship  voyager  secret level although unclassified user would see value starship p tuple personname  mr spock  tuple deleted result cascadesdelete action therefore user able infer tuple contained starship  voyager  channel attribute value  mr spock  classified secret would channel hence cascade delete rule fails relation elementlevel labeling c fk c pk nonforeign key attribute value referencing tuple lower security level foreign key attribute value even though cascadesdelete rule invalid case channel exist covered removed hence cascadesdelete used defining integrity constraint relation elementlevel labeling allow foreign key strictly dominate corresponding primary key sod starship objective destination enterprise u exploration u talos u voyager u spying mar apollo spying moon p personname starship james kirk u enterprise u mr spock u voyager figure  relation sod p without polyinstantiation iii nullifiesdelete rule delete rule specified nullifiesdelete value starship  voyager  relation p set null tuple sod starship  voyager  deleted conflict security constraint long writeups allowed since would downward flow information iv set defaultdelete rule argument set defaultdelete rule nullifiesdelete rule previously noted set default rule equivalent nullifies rule null specified default summary foreign key value higher security level primary key value nullifiesdelete rule set defaultdelete create downward information flow however restricteddelete cascade delete rule result covert channel b update rule discussed section  four update rule referential integrity singlelevel relation follows restrictedupdate rule ii cascadesupdate rule iii nullifiesupdate rule iv set defaultupdate rule following paragraph discus application update rule multilevel relation labeled element level restrictedupdate rule consider relation sod p given figure  relation p security level foreign key value starship  voyager  dominates primary key value relation sod according restrictedupdate rule long tuple foreign key value  voyager  p primary key value  voyager  updated relation sod give rise channel flow information highlevel referencing foreign key lowlevel subject attempting delete tuple containing primary key therefore restrictedupdate rule work updating referenced tuple security level referencing tuple dominates security level referenced tuple ii cascadesupdate rule cascadesupdate rule state primary key value starship  voyager  sod updated foreign key value starship  voyager  p also updated conflict security constraint long writeups allowed since would downward flow information iii nullifiesupdate rule nullifiesupdate rule specifies value starship  voyager  relation p set null starship  voyager  sod updated conflict security constraint long writeups allowed since would downward flow information iv set defaultupdate rule set defaultupdate rule violate security integrity constraint security level foreign key dominates security level primary key explanation nullifiesupdate rule summary cascadesupdate nullifiesupdate set defaultupdate result downward information flow restrictedupdate rule result covert channel c insert rule insert rule integrity state insertion foreign key value comply referential integrity rule foreign key value referencing relation identical primary key value referenced relation ml database important ensure downward flow information insertion made security level referencing tuple foreign key value dominates security level referenced tuple primary key value possibility channel higher user attempt insert foreign key value user insertion accepted rejected based presence absence referenced value lower security level upward flow information mean integrity security rule satisfied noted unlike polyinstantiated relation confusion inserting tuples two relation sod starship objective destination tc enterprise exploration talos u enterprise spying mar p personname starship tc james kirk enterprise u mr spock enterprise figure  relation tuplelevel granularity tuplelevel granularity argument referential integrity control relation tuplelevel granularity discussion elementlevel granularity difference instead data element individual security level entire tuple relation assigned security level shown figure  case elementlevel granularity security conflict occurs restrictedupdatedelete option enforced downward flow information low user try updatedelete target value allowed depending absence matching referencing tuple higher level integrity rule valid relation tuplelevel granularity problem cascadesdelete occurs elementlevel granularity occur tuplelevel granularity tuplelevel granularity element tuple explicitly assumed security level defined tuple class user never situation view attribute tuple others witness tuple vanish due cascading delete attribute user cleared see would covert channel due inference high attribute value attributelevel granularity described earlier attributelevel granularity mean attribute relation assigned single security level value attribute classified level security across tuples relation discussion section  maintain referential integrity security level foreign key attribute referencing relation must dominate security level primary key attribute referenced relation case considered security level foreign key attribute strictly dominates security level apparent primary key attribute case relation sod p given figure  sod starship u objective destination u enterprise exploration talos voyager spying mar p personname u starship james kirk enterprise mr spock enterprise figure  relation attributelevel granularity following discussion earlier observed integrity rule applied case except restricteddelete restrictedupdate rule restrictedupdate delete whenever lower subject try update delete tuple containing particular primary key attribute value attempt accepted rejected based presence matching value foreign key attribute higher security level give rise channel relationlevel granularity defined earlier relation relationlevel granularity single classification level defined entire relation word data element relation security level instance consider relation schema sod given example relation schema p given example relation p reference relation sod starship foreign key attribute security level primary key  starship  ie c pk security level relation sod security level foreign key  starship  ie c fk security level relation p based restriction derived rule section  security level foreign key always dominate security level primary key therefore relationlevel granularity security level relation p dominate security level relation sod let security level relation sod unclassified p secret c fk secret c pk unclassified ie c fk c pk discussion section  seen c fk c pk integrity rule except restricteddelete restrictedupdate used without covert channel table give summary integrity rule apply different level granularity without compromising secrecy permitting downward information flow case polyinstantiated relation necessary case method unambiguously determine instance apparent key referenced level granularity element tuple attribute relation insert rule ok ok ok ok delete rule restricteddelete channel channel channel channel cascadesdelete channel ok ok ok nullifiesdelete ok ok ok ok setdefault delete ok ok ok ok update rule restrictedupdate channel channel channel channel cascadesupdate ok ok ok ok nullifiesupdate ok ok ok ok setdefault update ok ok ok ok table  summary covert channel referential integrity rule c fk c pk  relation dbms architecture trusted computing base tcb consists one subelements together enforce security policy system complex system distribute policy enforcement various sub element determining trust characteristic complex system basis collection subpart well understood approach arguing composition system approach used tdi view system composed hierarchicallyordered system  privilege  hierarchy characterized dependency construct developed dealing layered system tcb subset tcb subset enforces security policy set resource layer may may include hardware tcb subset shown constrained unprivileged relative primitive tcb subset obtains resource scope covert channel analysis limited example approach seaview prototype sri international developed seaview prototype multilevel rdbms validate seaview theoretical model demonstrate prototype suitable engineering development hsieh design approach provides user elementlevel labeling seaview construct multilevel relation view stored singlelevel relation singlelevel relation stored file managed underlying multilevel operating system thus individually labeled data element need stored individually labeled storage object seaview approach allows multilevel database operation decomposed corresponding singlelevel operation singlelevel relation decomposition transparent user considers multilevel relation stored relation thus seaview model extends entity referential integrity multilevel relation also allows application dependent integrity rule defined multilevel relation ensures update multilevel relation well defined addition seaview model constrains multilevel relation polyinstantiation integrity specifies consistency polyinstantiated tuples element seaview approach underlying architecture guard covert channel enforcement entity referential integrity dbms instance operating behalf subject untrusted respect underlying operating system mac policy ie read data security level dominated subject level write data security level dominating subject level sri utilized trusted oracle o mac mode evaluated constrained tcb subset architecture oracle hand secure dbms built mac enforcement done dbms underlying operating system approach dbms privilege violate operating system mac control architecture called trusted subject architecture dbms designer make tradeoff channel free enforcement entity referential integrity constraint enforcement constraint manner allows selected channel latter case constraint enforcement mechanism must carefully analyzed make sure downward information flow thoroughly understood acceptable target environment evaluation class example trusted oracle dbms mac mode us trusted subject architecture successfully evaluated class b oracle dbms mac mode entity referential integrity enforced audit event added trusted oracle detect use potential covert channel section summary entity integrity referential integrity two important integrity constraint enforced dbms entity integrity necessary preserving correctness data within relation referential integrity required maintaining interrelation integrity relational data model document concept extended multilevel dbms extension concept referential integrity singlelevel relation multilevel relation straightforward restriction needed provide referential integrity control multilevel dbms without compromising secrecy basic requirement referential integrity referencing foreign key value must identical target primary key value referenced relation additional requirement multilevel relation foreign key primary key uniformly classified ie attribute included key security level foreign key dominates referenced primary key discussion document concluded enforcing referential integrity security level foreign key equal security level referenced primary key simple without ambiguity integrity rule apply case whether relation allow polyinstantiation polyinstantiation allowed method including security level primary foreign key value part key must used differentiate reference allow referential integrity rule enforced referential integrity completely fails security level foreign key dominate security level primary key security level foreign key strictly dominates security level referenced primary key integrity rule action taken upon deletion modification key value applied without channel difference based labeling granularity inclusion mechanism enforces integrity across security level class b dbms may feasible due conflict covert channel requirement however successful evaluation trusted oracle dbms mac mode unmodified integrity mechanism precedence set class b dbms reference ansi ansi database language sql ansi x american national standard institute new york december ansi ansi sql working draft draft version available x secretariat computer business equipment manufacturer association cbema eye st nw suite washington dc  september audit national computer security center auditing issue secure database management system ncsc technical report volume  may bell e bell l j lapadula secure computer system unified exposition multics interpretation mitre corporation march burn r k burn integrity secrecy fundamental conflict database environment proceeding third radc database security workshop castille ny burn b r k burn referential secrecy proceeding ieee symposium security privacy ieee computer society press may clark clark r wilson comparison commercial military computer security policy proceeding ieee symposium security privacy oakland ca may clark clark r wilson evolution model computer integrity proceeding th national computer security conference baltimore md october dac national computer security center discretionary access control issue high assurance secure database management system ncsc technical report volume  may date c j date introduction database system vol th edition addison wesley reading date c j date referential integrity foreign key consideration relational database writing  addisonwesley pp  denning e denning f lunt r r schell heckman w r shockley  multilevel relational data model  proceeding ieee symposium security privacy ieee computer society press pp  dod department defense trusted computer system evaluation criterion dod std washington dc december hsieh hsieh lunt p boucher seaview prototype rltr final technical report sri international november horowitz b horowitz runtime execution model referential integrity maintenance proceeding th international conference data engineering tempe az pp  february inference national computer security center inference aggregation issue secure database management system ncsc technical report volume  may jajodia jajodia r sandhu polyinstantiation integrity multilevel relation proceeding ieee symposium security privacy oakland ca may jajodia jajodia r sandhu toward multilevel secure relational data model proceeding acm sigmod international conference management data denver co pp  may jajodia jajodia g mark maintaining secrecy integrity multilevel database practical approach proceeding th national information system security conference baltimore md oct  khoshafian n khoshafian g p copeland object identity proceeding oopsla  pp  september lunt f lunt e denning r r schell heckman w r shockley seaview security model ieee transaction software engineering vol pp  june lunt f lunt hsieh update semantics multilevel relational database system database security iv status prospect jajodia c e landwehr editor elsevier science publisher b v north holland ifip pp  maimone b maimone r allen method resolving security v integrity conflict research direction database security iv proceeding fourth radc workshop rae burn editor april markowitz v markowitz referential integrity relational database management system comparative study preprint meadow c meadow jajodia integrity versus security multilevel secure database database security status prospect ed c landwehr north holland notargiacomo l notargiacomo database integrity based clarkwilson integrity model proceeding rd radc database security workshop oracle oracle trusted oracle final evaluation report ncscepl c evaluation report  library national computer security center april poly national computer security center polyinstantiation issue multilevel secure database management system ncsc technical report volume  may sandhu r sandhu jajodia honest database keep secret proceeding th national computer security conference washington dc oct tdi trusted database management system interpretation trusted computer system evaluation criterion ncsctg national computer security center april van de reit r van de reit j beukering integration security integrity constraint mokum proceeding th ifip  wg database security bad sdzdetfurth germany  august wiseman wiseman control integrity database proceeding th ifip  wg database security halifax england  september rank personname primary key pr foreign key primary key starship personname foreign key p primary key starship objective destination sod keith f brewster acting chief partnership process may 