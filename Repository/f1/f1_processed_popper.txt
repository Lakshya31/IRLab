 hack shell access user use  popper  create root owned file system unix source mark fullmer maf cobohiostateedu bugtraq date fri may  system varspoolmail mode drwsrwxrwt use berkeley popper daemon user access varspoolmail ie user shell login create arbitrary root owned file host popper executed ondepending umask popper run file may also world writeable detail version ucb pop server version beta line popdropcopyc currently running root poptmpdrop usrspoolmailtmpxxxxxx strcpy template poptmpdrop void mktemp template race start user guess pathname  template  could previously made link say etcnologin instead script exploit bug verify exists adding sleep  mktemp fopen make race condition easy win ofcourse allready need root able  tffopen template  w   null  failure bail  poplog p poppriority  unable create temporary temporary maildrop  template errno sysnerr syserrlist errno   return popmsg p popfailure  system error ca nt create temporary file  point file created depending umask popper run file may world write permission chownchmod wo nt follow link  give file user  void chown template pwp pwuid pwp pwgid void chmod template  link file temporary maildrop fails probably temporary maildrop already exists ok go way time try write file running user  void link template p tempdrop void fclose tf void unlink template  run user  void setuid pwp pwuid void setgid pwp pwgid solution varspoolmail mode drwsrwxrwt code isnt necessary remove line  popdropcopyc nt entirely solve problem especially root read mail via popper best solution varspoolmail world write permission type problem exists atleast one delivery agent binmail probably user agent 