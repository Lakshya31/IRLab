improving security unix system david curry system programmer information telecommunication science technology division itstdfr approved paul k hyder manager computer facility boyd c fair general manager division operation section michael frankel vice president information telecommunication science technology division final report april sri international ravenswood avenue menlo park ca   fax  telex section introduction  unix security unix operating system although widespread use environment concerned security really designed security mind ritc mean unix provide security mechanism indeed several good one available however box  installation procedure company sun microsystems still install operating system much way installed year ago little security enabled reason state affair largely histori cal unix originally designed programmer use programmer environment used one open cooperation one privacy programmer typi cally collaborated project hence pre ferred able share file without climb security hurdle first site outside bell laboratory install unix university research laboratory similar environment existed real need greater security seen time later early many university began move unix system research laboratory com puter center allowing forcing user population whole use new wonderful system many business government site began install unix system well particularly desktop workstation became powerful affordable thus unix operating system longer used environment open collaboration goal university require student use system class assignment yet want student able copy business use unix system confidential task bookkeeping payroll government us unix system various unclassified yet sen sitive purpose complicate matter new feature added unix year making security even difficult control perhaps problematic feature  unix registered trademark vax trademark digital equipment corporation sun nfs trademark sun microsystems annex trademark xylogics inc relating networking remote login remote command execution network file system diskless workstation electronic mail feature increased utility usability unix untold amount however feature along widespread connection unix system internet network opened many new area vulnerability unauthorized abuse system  internet worm evening november selfreplicating program called worm released internet seel spaf eich overnight program copied machine machine causing machine infected labor huge load denying service user machine although program infected two type computer spread quickly concern confu sion sometimes panic system administrator whose machine affected many system administrator aware something like could theoretically happen security hole exploited worm well known scope worm breakins came great surprise people worm destroy file steal information account password intercept private mail plant destructive software seel however manage severely disrupt operation network several site including part mit nasa ames research center goddard space flight center jet propulsion laboratory u army ballistic research laboratory disconnected internet avoid recontamina tion addition defense communication agency ordered connection milnet arpanet shut kept nearly hour eich elme ironi cally perhaps worst thing since first fix combat worm distributed via network eich incident perhaps widely described com puter security problem ever worm covered many newspaper magazine around country including new york time wall street journal time computer oriented technical publication well three major  sun system sun microsystems vax system di gital equipment corp running variant x bsd unix university california berkeley television network cable news network national pub lic radio january united state district court jury found robert tappan morris author worm guilty charge brought federal computer fraud abuse law morris face five year prison  fine schu sentencing scheduled may  spy espionage august lawrence berkeley laboratory unclassified research laboratory university califor nia berkeley attacked unauthorized computer intruder stol stol instead immediately closing hole intruder using system administrator clif ford stoll elected watch intruder document weakness exploited next month stoll watched intruder attack computer around world successfully enter computer broken located university military base defense contractor stol unlike many intruder seen internet typically enter system browse around see intruder looking something specific file data dealing strategic defense initiative space shut tle military topic seemed special interest although unlikely intruder would found truly classified information internet unclassified network highly probable could find wealth sensitive material stol year tracking intruder eventually involv ing fbi cia national security agency air force intelli gence authority west germany five men hannover west germany arrested march five charged espionage selling material found exploit kgb one men karl koch hagbard  later found burned death iso lated forest outside hannover suicide note found stol february three intruder markus hess dirk bresinsky peter carl convicted espionage german court sentenced prison term fine loss right participate election risk last intruder han hu  bner pengo  still face trial berlin  breakins numerous computer security problem occurred recent year varying level publicity widely known incident include breakins nasa span network mcle ibm christmas virus  risk virus mitre corp caused milnet temporarily iso lated network risk worm penetrated dec net network riska breakins u banking network riskb multitude virus worm trojan horse affecting personal computer user  security important previous story demonstrate computer security important topic document describes security feature provided unix operating system used discussion center around version x sunos version unix sold sun microsystems information presented applies equally well unix system although way make computer com pletely secure unauthorized use lock room turn following instruction document make system impregnable casual  system cracker make difficult sophisticated cracker penetrate  term hacker  applied computer user originally honorable connotation person enjoys learning detail programming system stretch capabili tie opposed user computer prefer learn minimum amount necessary  stee unfortunately medium distorted definition given dishonorable meaning deference true hacker use term cracker  throughout document section improving security unix system security divided three main area concern two area account security network security primarily concerned keeping unauthorized user gaining access system third area file system security concerned preventing unauthorized access either legitimate user cracker data stored system section describes unix security tool provided make area secure possi ble  account security one easiest way cracker get system breaking someone account usually easy since many system old account whose user left organization account easytoguess password section describes method used avoid problem  password password vital part unix account secu rity cracker discover user password log system operate capability user password obtained superuser problem serious cracker read write access every file system reason choosing secure password extremely important unix passwd program suna place re trictions may used password generally requires password contain five lowercase letter four character nonalphabetic uppercase letter included however user insists  shorter password used entering three time program allow check obviously insecure password see performed thus incumbent upon system administrator ensure password use system secure morr author describe experiment conducted determine typical user habit choice password collection  password contained three character le astonishing could gen erally described insecure additional experiment gram show trying three simple guess account login name login name reverse two concatenated together cracker expect obtain access percent account typical system second experiment showed trying common female first name followed single digit total password least one password valid several dozen machine surveyed experimentation author found trying variation login name user first last name list nearly common first name percent password given system cracked matter two three day  selecting password object choosing password make dif ficult possible cracker make educated guess chosen leaf alternative bruteforce search trying every possible combination letter number punctuation search sort even conducted machine could try one million password per second machine try le one hundred per second would require average one hundred year complete goal using informa tion preceding text set guideline password selection constructed dont use login name form asis reversed capitalized doubled etc dont use first last name form dont use spouse child name dont use information easily obtained includes license plate number telephone number social security number brand automobile name street live etc dont use password digit letter significantly decrease search time cracker dont use word contained english foreign language dictionary spelling list list word dont use password shorter six character use password mixedcase alphabetics use password nonalphabetic character eg digit punctuation use password easy remember nt write use password type quickly without look keyboard make harder someone steal password watching shoulder although list may seem restrict password extreme several method choosing secure easy toremember password obey rule include following choose line two song poem use first letter word example xanadu kubla kahn stately pleasure dome decree  becomes ixdkkaspdd  alternate one consonant one two vowel eight character provides non sense word usually pronounceable thus easily remembered example include routboo  quadpop  choose two short word concatenate together punctation character exam ple dog rain  bookmug  kid goat  importance obeying password selection rule overemphasized internet worm part strategy breaking new machine attempted crack user password first worm tried simple choice login name user first last name next worm tried word present internal dictionary word presumably morris considered word good  word try else failed worm tried going system dictionary usrdictwords trying word spaf password selection rule suc cessfully guard three strategy  password policy although asking user select secure password help improve security enough also important form set password policy user must obey order keep password secure first foremost important impress user need keep password mind pas word never written desk blotter calendar like storing password file com puter must prohibited either case writing pas word piece paper storing file security user account totally dependent security paper file usually le security offered password encryption software second important policy user must never give password others many time user feel easier give someone else password order copy file rather set permission file copied unfortunately giving pas word another person user placing trust person distribute password write finally important establish policy user must change password time time say twice year difficult enforce unix since implementation passwordexpiration scheme available however way implement policy either using thirdparty software sending memo user requesting change password set policy printed distributed current user system also given new user receive account policy usually carry weight get signed impressive  person organization eg president company  checking password security procedure policy described previous sec tions properly implemented greatly reduce chance cracker breaking system via stolen account however security measure system administrator must periodically check sure policy procedure adhered one unfortunate truism password security left way people still use cute doggie name password  gram best way check security password system use passwordcracking program much like real cracker would use succeed cracking pas word password changed immediately freely available password cracking program distri buted via various source archive site described detail section fairly extensive cracking program also available author alternatively write cracking program tailor site list thing check see list guideline  expiration date many site particularly large number user typically several old account lying around whose owner since left organization account major security hole broken password insecure nobody using account anymore unlikely breakin noticed simplest way prevent unused account accumu lating place expiration date every account expiration date near enough future old account deleted timely manner yet far enough apart user become annoyed good figure usually one year date account installed tends spread expiration year rather clustering beginning end expiration date easily stored password file full name field simple shell script used periodically check account expiration date none date passed first day month user whose account expired contacted sure still employed organization actively using account user contacted used account recently deleted system user unavailable reason eg vacation contacted account disabled replacing encrypted password password file entry asterisk make impossible log account yet leaf account available reenabled user return  guest account guest account present still another security hole nature account rarely used always used people access machine short period time guest secure way handle guest account install asneeded basis delete soon people using leave guest account never given simple password guest  visitor  never allowed remain password file used  account without password site installed account name  date  lpq  execute simple com mands account intended allow user execute command without log machine typi cally account password associated thus used anyone many account given user id zero execute superuser permis sion problem account open poten tial security hole password superuser permission account practically invite cracker try penetrate usually cracker gain access system penetrating account simple account executes different command cracker replace one command one use unprotected account execute program superuser permission simply put account without password allowed unix system  group account group group account become popular many site actually breakin waiting happen group account single account shared several people eg col laborators project mentioned section pas word security user share password group account concept directly violates policy proper way allow user share information rather giving group account use place user group done editing group file etcgroup suna sunb creating new group user wish collaborate listed member line group file look like groupname password groupid user user user  groupname name assigned group much like login name may someone login name different maximum length group name eight charac ters password field unused bsdderived version unix contain asterisk groupid number inclusive generally number reserved special purpose may choose unused number last field commaseparated space list login name user group login name listed group member create group called hacker  huey duey louie member would add line group file hacker  huey duey louie group created file direc tory member wish share changed owned group group permission bit file directory set allow sharing user retains account password thus pro tecting security system example change huey program  directory owned new group properly set permission member group may access chgrp chmod command would used follows suna  chgrp hacker hueyprograms chmod r grw hueyprograms  yellow page sun yellow page system sunb  allows many host share password file group file file via network file stored single host unfortunately yellow page also contains potential secu rity hole principal way yellow page work special line password group file begin  password file line look like  group file look like line present file stored yel low page client machine present file yellow page master machine program read password group file encounter one line go network request information want yellow page server instead trying find local file way data maintained every host since master machine already information need special line present generally speaking yellow page service reasonably secure opening sophisti cated dedicated cracker could exploit sun rapidly closing biggest problem yellow page  line password file  deleted front line line loses special yellow page meaning instead becomes regular password file line account null login name password user id zero superuser thus careless system administrator accidentally deletes  whole system wide open attack yellow page useful service suggest turning although turning would make system secure instead recommended read carefully information sun manual order fully aware yellow page ability limitation  network security  actually line like without  dangerous password file regardless whether yellow page use trend toward internetworking continue site nt already connect one numerous regional network springing around country regional network also interconnected form ing internet hind quar mean user machine access host communicate user around world unfortunately also mean host user around world access machine attempt break internetworking became commonplace protecting system unauthorized access simply meant locking machine room machine connected network however security much complex sec tion describes tool method available make unix network secure possible  trusted host one convenient feature berkeley sun unix networking software concept trusted  host software allows specification host possibly user considered trusted remote logins remote command execution host permitted without requiring user enter password convenient user type password every time use network unfortunately reason concept trusted host also extremely insecure internet worm made extensive use trusted host concept spread throughout network seel many site already disallowed trusted host fairly well worm compared site allow trusted host even though security hole valid us trusted host concept section describes properly implement trusted host facility preserving much security possible  hostsequiv file file etchostsequiv suna used system administrator indicate trusted host trusted host listed file one host per line user attempt log using rlogin execute command using rsh remotely one system listed hostsequiv user account local system login name access permitted without requiring password provided adequate care taken allow local host hostsequiv file reasonable compromise secu rity convenience achieved nonlocal host includ ing host remote site organization never trusted also machine organization installed public  area eg ter minal room opposed private office trust host sun system hostsequiv controlled yellow page software distributed default hostsequiv file distributed sun contains single line indicates every known host ie complete con tent host file considered trusted host totally incorrect major security hole since host outside local organization never trusted correctly configured hostsequiv never list wildcard  host  specific host name used installing new system sun distribution tape sure either replace sun default hostsequiv correctly configured one delete file altogether  rhosts file rhosts file suna similar concept format hostsequiv file allows trusted access specific hostuser combination rather host general user may create rhosts file home directory allow access account without password people use mechanism allow trusted access account system owned different organization trust host hostsequiv unfor tunately file present major security problem hostsequiv system administrator control managed effectively user may create rhosts file granting access whomever chooses without system administrator knowledge  actually hostsequiv may used specify hostuser combi nation well rarely done secure way manage rhosts file com pletely disallow system system administrator check system often violation policy see section  one possible exception rule root  account rhosts file may necessary allow network backup like completed  secure terminal newer version unix concept secure  terminal introduced simply put superuser root  may log nonsecure terminal even password authorized user may still use su command become superuser however file etcttytab suna used control terminal considered secure short excerpt file shown console  usretcgetty std  sun secure ttya  usretcgetty std  unknown secure ttyb  usretcgetty std  unknown secure ttyp none network secure ttyp none network secure ttyp none network secure keyword secure  end line indicates terminal considered secure remove designation simply edit file delete secure  keyword saving file type command superuser kill hup tell init process reread ttytab file sun default configuration ttytab consider terminal secure including pseudo  terminal used remote login software mean root  may log remotely host network secure confi guration would consider secure directly connected ter minals perhaps console device file server machine disk set secure configuration remove secure  designation terminal including console device requires user superuser authority first log become superuser via su   nonsun version berkeley unix file called etcttys command also requires root  password entered rebooting singleuser mode order prevent user rebooting desktop workstation obtaining super user access diskless client machine set  network file system network file system nfs sund designed allow several host share file network one common us nfs allow diskless workstation installed office keeping disk storage central location distributed sun nfs security feature enabled mean host internet may access file via nfs regardless whether trust fortunately several easy way make nfs secure commonly used method described section used make file quite secure unauthorized access via nfs secure nfs introduced sunos release  take security one step using publickey encryption technique ensure authorized access discussion secure nfs deferred section  export file file etcexports suna perhaps one important part nfs configuration file list file system exported made available mounting system typical export file installed sun installation procedure look something like usr home varspoolmail exportrootclient accessclient rootclient exportswapclient accessclient rootclient exportrootclient accessclient rootclient exportswapclient accessclient rootclient root keyword specifies list host allowed superuser access file named file system keyword discussed detail section  access keyword specifies list host separated colon allowed mount named file system access keyword specified file system host anywhere network may mount file system via nfs obviously present major security problem since anyone mount file system via nfs peruse leisure thus important file sys tems listed export access keyword associated host must mount file system list individually file usr accesshost host host host host however maximum number host listed way ten access keyword also allow netgroups specified netgroups described next section making change export file run command exportfs order make change take effect  netgroup file file etcnetgroup suna used define netgroups file controlled yellow page must rebuilt yellow page map whenever modified consider following sample netgroup file agroup servera clienta clienta bgroup serverb clientb clientb adminstaff clienta mary clientb joan allsuns agroup bgroup file defines four netgroups called agroup bgroup adminstaff allsuns allsuns netgroup actually super group  containing member agroup bgroup netgroups member netgroup defined triple host user domain typically domain field never used simply left blank either host user field left blank host user considered match thus triple host match user named host triple user match named user host netgroups useful restricting access nfs file system via export file example consider modi fied version file previous section usr accessagroup home accessagroup bgroup varspoolmail accessallsuns exportrootclient accessclient rootclient exportswapclient accessclient rootclient exportrootclient accessclient rootclient exportswapclient accessclient rootclient usr file system may mounted host agroup netgroup servera clienta clienta host try mount file system receive access denied  error home file system may mounted host either agroup bgroup netgroups varspoolmail file system also restricted host example used super group  called allsuns generally best way configure netgroup file make single netgroup file server client make super group allsuns allows flexibility specify smallest possible group host file system etcexports netgroups also used password file allow access given host restricted member group used hostsequiv file central ize maintenance list trusted host procedure defined detail sun manual  restricting superuser access normally nfs translates superuser id special id called nobody  order prevent user root  remote workstation accessing people file good security sometimes nuisance system administration since make change file root  nfs export file also allows grant superuser access certain file system certain host using root keyword following keyword colonseparated list ten host may specified host allowed access file system root  without user id converted nobody  netgroups may specified root keyword granting root  access host done lightly host root  access file system superuser host complete access file system given root  password server untrusted host never given root  access nfs file system  ftp file transfer protocol implemented ftp ftpd program suna   allows user connect remote system transfer file back forth unfortunately older version program also several bug allowed cracker break sys tem bug fixed berkeley new version available ftpd obtained december get newer version see section one useful feature ftp anonymous  login special login allows user account machine restricted access order transfer file specific directory useful wish distribute software public large without giving person want software account machine order securely set anonymous ftp follow specific instruction create account called ftp  disable account placing asterisk password field give account special home directory usrftp usrspoolftp make home directory owned ftp  unwrit able anyone chown ftp ftp chmod ftp  sun system ftpd stored file usretcinftpd system called etcftpd make directory ftpbin owned superuser unwritable anyone place copy l program directory mkdir ftpbin chown root ftpbin chmod ftpbin cp p binls ftpbin chmod ftpbinls make directory ftpetc owned superuser unwritable anyone place copy pas word group file directory password field changed asterisk may wish delete account group file account must present ftp  mkdir ftpetc chown root ftpetc chmod ftpetc cp p etcpasswd etcgroup ftpetc chmod ftpetcpasswd ftpetcgroup make directory ftppub owned ftp  worldwritable user may place file accessible via anonymous ftp directory mkdir ftppub chown ftp ftppub chmod ftppub anonymous ftp feature allows anyone access system albeit limited way made available every host network instead choose one machine preferably server standalone host allow service make monitoring security violation much easier allow people transfer file machine using worldwritable pub directory described check often con tent directory allowed write suspicious file find deleted  trivial ftp trivial file transfer protocol tftp used sun workstation others allow diskless host boot network basically tftp strippeddown version ftp user authentication connection based user datagram protocol instead transmission con trol protocol strippeddown many imple mentation tftp security hole check host executing command sequence shown tftp tftp connect yourhost tftp get etcmotd tmp error code  file found tftp quit version respond file found  instead transfer file replace version tftpd newer one particular version sunos prior release  known problem  mail electronic mail one main reason connecting outside network version berkeleyderived unix system including sun sendmail program suna  sunb  used enable receipt delivery mail ftp software older version sendmail several bug allow security vio lations one bug used great success internet worm seel spaf current version send mail berkeley version  january sun writing still shipping version  known security problem however made fixed ver sion available section detail obtain newer version generally exception security hole men tioned sendmail reasonably secure installed vendor installation procedure however precaution taken ensure secure opera tion remove decode  alias alias file etcaliases usrlibaliases  sun system tftpd stored file usretcintftpd system called etctftpd create alias allow message sent program absolutely sure way obtain shell send command shell program make sure wizard  password disabled configuration file sendmailcf unless modify distributed configuration file shouldnt problem make sure sendmail support debug  command done follow ing command telnet localhost yourhost sendmail  ready mar  pst debug command unrecognized quit sendmail responds debug  command  debug set  vulnerable attack replace sendmail newer version following procedure sure mail system secure  finger finger  service provided finger program suna  allows obtain information user full name home directory last login time case last received mail andor read mail fingerd program suna allows user remote host obtain information bug fingerd also exercised success internet worm seel spaf version fingerd older november replaced newer version new version available several source described section  sun system fingerd stored usretcinfingerd system called etcfingerd  modem terminal server modem terminal server terminal switch annex box etc present still another potential security problem main problem device one configuration misconfigured hardware allow security breach explaining configure every brand modem terminal server would require volume however following item checked modem terminal server installed site user dialed modem hang phone system log nt check hardware connection kernel configuration serial port user log system force modem hang check hardware connection nt work connection terminal server sys tem broken system log user terminal server connected modem user hang terminal server inform system user hung modem terminal server manual cover detail properly connect device system particu lar pay close attention carrier detect  clear send  request send  connection  firewall one newer idea network security firewall basically firewall special host sits outsideworld network connection internal network host send routing information internal network thus internal network invisible  outside order config ure firewall machine following consideration need taken firewall advertise route mean user internal network must log firewall order access host remote network likewise order log host internal network outside user must first log firewall machine incon venient secure electronic mail sent user must warded firewall machine delivered outside internal network firewall must receive incoming electronic mail redistribute done either alias user using name server mx record firewall machine mount file sys tems via nfs make file system avail able mounted password security firewall must rigidly enforced firewall host trust host regardless furthermore firewall trusted host anonymous ftp similar service provided firewall host pro vided purpose firewall prevent cracker accessing host network mean general must maintain strict rigidly enforced security firewall host le vulnerable hence security may somewhat lax important remember firewall complete cure cracker cracker break firewall machine try break host network  file system security last defense system cracker permis sion offered file system file directory three set permission bit associated one set user owns file one set user group file associated one set user world  permission set contains three identical permission bit control following read set file directory may read case directory read access allows user see content directory name file contained therein access write set file directory may written modified case directory write permission implies ability create delete rename file note ability remove file controlled permis sion file rather permission directory containing file execute set file directory may executed searched case directory execute permission implies ability access file contained directory addition fourth permission bit available set permission bit different meaning set permission bit setuid set owner permission bit control set user id  setuid status file setuid status mean program exe cuted executes permission user owning program addition per mission user executing program example sendmail setuid root  allowing write file mail queue area mal user allowed bit meaningless nonexecutable file setgid set group permission bit control set group id  setgid status file behaves exactly way setuid bit except group id affected instead bit meaningless nonexecutable file see sticky set world permission sticky  bit tell operating system special thing text image executable file mostly holdover older version unix little use today bit also meaningless nonexecutable file see  setuid shell script shell script setuid setgid bit set secure regardless many safeguard taken writing numerous software package avail able claim make shell script secure every one released far managed solve problem setuid setgid shell script never allowed unix system  sticky bit directory newer version unix attached new meaning sticky bit bit set directory mean user may delete rename user file direc tory typically useful tmp directory mally tmp worldwritable enabling user delete another user file setting sticky bit tmp user may delete file directory set sticky bit directory use command chmod ot directory  setgid bit directory sunos  setgid bit also given new meaning two rule used assigning group ownership file sunos system v mechanism say user pri mary group id one listed password file assigned file creates berkeley mechanism say group id file set group id directory created setgid bit set directory berkeley mechanism enabled otherwise system v mechanism enabled normally berkeley mechanism used mechan ism must used creating directory use one member group see section  set setgid bit directory use command chmod g directory  umask value file created program say text editor compiler typically created permission enabled since rarely desirable nt want user able write file umask value used modify set permission file created simply put chmod command suna  specifies bit turned umask value specifies bit turned example default umask system mean write permission group world turned whenever file created instead wanted turn group world permission bit file created would readable writable executable anyone except would set umask umask value specified cshrc profile file read shell using umask command suna root  account line umask cshrc file order prevent accidental creation worldwritable file owned superuser  encrypting file standard unix crypt command suna secure although reasonable expect crypt keep casual browser  reading file present noth ing minor inconvenience determined cracker crypt implement onerotor machine along line ger man enigma broken world war ii method attack machine well known sufficiently large file usually decrypted hour even without knowledge file contains reed fact publicly available package program designed break  file encrypted crypt around several year software implementation another algorithm data encryption standard de available system although algorithm much secure crypt never proven totally secure many doubt security raised recent year perhaps best thing say encrypting file computer system think file whose con tent important enough encrypt file stored computer first place especially true system limited security unix system personal computer important note unix password encrypted crypt program instead encrypted modified version de generates oneway encryp tions password decrypted log system decrypt password instead encrypts attempted password come result encrypting real password allowed log  device security device important issue unix dev ice file usually residing dev used various program access data disk drive memory device file properly protected system wide open cracker entire list device long go since varies widely system system however following guideline apply system file devkmem devmem devdrum never readable world system sup port notion kmem  group newer sys tems utility p setgid kmem  file owned user root  group kmem  mode system support notion kmem  group utility p setuid root  file owned user root  mode disk device devsda devrxyb etc owned user root  group opera tor  mode note disk eight partition two device file parti tion thus disk sd  would following device file associated dev sda sde rsda rsde sdb sdf rsdb rsdf sdc sdg rsdc rsdg sdd sdh rsdd rsdh exception device owned user root  one exception terminal changed owned user currently logged user log owner ship terminal automatically changed back root   security responsibility section detailed numerous tool improving secu rity provided unix operating system important thing note tool although avail able typically put use installation therefore incumbent system administrator take time make effort enable tool thus protect system unauthorized access section monitoring security one important task keeping computer sys tem secure monitoring security system involves examining system log file unauthorized access system well monitoring system security hole section describes procedure additional part monitoring security involves keeping abreast security problem found others described sec tion  account security account security monitored periodically order check two thing user logged nt  eg late night vacation etc user executing command would nt normally expected use command described section used obtain information system  lastlog file file usradmlastlog suna record recent login time user system message printed time log eg last login sat mar  spamitstdsric us time stored lastlog file additionally last login time reported finger command us time user told carefully examine time whenever log report unusual login time system administra tor easy way detect account breakins since user remember last time logged system  utmp wtmp file file etcutmp suna used record currently logged system file displayed using command suna hendra ttyc mar  heidari tty mar  welgem tty mar  reagin ttyp mar  aaifsitstdsri ghg ttyp mar  hydrariacsedu compion ttyp mar  eiecnpurdueed user login name terminal used login time remote host user logged via network displayed file usradmwtmp suna record login logout time every user file also displayed using command usradmwtmp davy ttyp jan  annexriacsed ttyp jan  davy ttyp jan  annexriacsed ttyp jan  hyder ttyp jan  triceratopsitst ttyp jan  line contains login name indicates time user logged line login name indicates time terminal logged unfortunately output command rarely simple example several user log login logout time mixed together must matched hand using terminal name wtmp file may also examined using last command suna command sort entry file matching login logout time argument last display information file giving name user terminal output restricted information user terminal question sample output last command shown last davy ttyp intrepiditstds tue mar    hyder ttyp clydeitstdsri mon mar    reboot mon mar  shutdown mon mar  arm ttyp clydeitstdsri mon mar    hyder ttyp spamitstdsric sun mar    reboot sat mar  davy ftp hydrariacsedu sat mar    login session user name terminal used remote host user logged via network login logout time session duration shown additionally time system shutdown reboots generated shutdown reboot command suna recorded unfor tunately system crash recorded newer version operating system pseudo logins via ftp command also recorded example shown last line sample output  acct file file usradmacct suna  record exe cution command system executed long took information logged time command completes kernel compiled sysacct option enabled option enabled generic kernel usually disabled default acct file displayed using lastcomm command suna argument information file displayed however giving command name user name terminal name argument output restricted information given command user terminal sample output lastcomm shown lastcomm sh root   sec tue mar  atrun root   sec tue mar  lpd f root   sec tue mar  lpr burwell tty  sec tue mar  troff burwell tty  sec tue mar  eqn burwell tty  sec tue mar  df kindred ttyq  sec tue mar  l kindred ttyq  sec tue mar  cat kindred ttyq  sec tue mar  stty kindred ttyq  sec tue mar  tbl burwell tty  sec tue mar  rlogin jones ttyp  sec tue mar  rlogin f jones ttyp  sec tue mar  stty kindred ttyq  sec tue mar  first column indicates name command next column display certain flag command f  mean process spawned child process  mean process ran setuserid bit set  mean process exited core dump x  mean process killed abnormally remaining column show name user ran program terminal ran applicable amount cpu time used command second date time process started  network security monitoring network security difficult many way cracker attempt break however program available aid task described section  syslog facility syslog facility suna mechanism enables command log error message informational me sage system console well log file typi cally error message logged file usradmmessages along date time name program sending me sage usually process id program sample seg ment message file shown mar  sparkyfs login root login ttyp setekfsitstdsr mar  sparkyfs login root login ttyp setekfsitstdsr mar  sparkyfs login root login ttyp pongfsitstdsri mar  sparkyfs vmunix sdc read failed retries mar  sparkyfs vmunix file system full mar  sparkyfs login root login ttyp triceratopsitst mar  sparkyfs su davy devttyp mar  sparkyfs login root login ttyp triceratopsitst mar  sparkyfs automount host aaifs responding mar  sparkyfs login repeated login failure ttyp intrepiditstds daemon particular interest sample message login su program whenever someone log root  login log information generally logging root  directly rather using su command discouraged hard track person actually using account ability disabled described section  detecting security violation becomes simple matter searching message file line type login also log case someone repeatedly trying log account failing three attempt login refuse let person try anymore searching message message file alert cracker attempting guess someone password finally someone us su command either become root  someone else su log success failure operation message used check user sharing password well cracker penetrated one account trying penetrate others  showmount command showmount command suna used nfs file server display name host currently something mounted server option program simply display list host option output somewhat useful first option cause showmount list host directory combina tions example brontoitstdsricom usrshare brontoitstdsricom usrlocalnew brontoitstdsricom usrsharelib brontoitstdsricom varspoolmail cascadesitstdsricom sparkya clydeitstdsricom laserdumps cmitstdsricom sparkya cocoitstdsricom sparkya one line output directory mounted host option showmount display list directory presently mounted host output showmount checked two thing first machine local organization appear set proper netgroups described sec tion  problem second mal  directory mounted find unusual direc tory mounted find mounting although probably innocent may indicate one trying get around security mechanism  file system security checking security hole file system another important part making system secure primarily need check file modified unauthorized user file inadvertently grant user many permission file inadvertently grant access cracker also important able detect unauthorized modification file system recover modification made  find command find command suna  generalpurpose com mand searching file system using various argument complex matching pattern based file name type mode owner modification time characteristic con structed name file found using pattern printed given argument unix com mands general format find command find directory option directory list directory name search eg usr option contains option control searched general example section always want search root file system order find file matching pattern presented section describes use find search four possible security problem described section  finding setuid setgid file important check system often unauthorized setuid setgid program program grant special privilege user executing necessary ensure insecure program installed setuid root  program closely guarded favorite trick many cracker break root  leave setuid pro gram hidden somewhere enable regain superuser power even original hole plugged command search setuid setgid file find type f perm  perm  print option command following meaning name directory searched case want search entire file system specify might instead restrict search usr home type f examine file whose type f  regular file option include  directory l  symbolic link c  characterspecial device b  blockspecial device specifies  thus want know file whose type regular file  whose permis sion bit match part expression perm  perm  parenthesis part command used grouping thus everything part command match single pattern treated half  clause described perm  specifies match  bit speci fied octal number set file per mission mode setuserid bit specifies  thus want match file setuserid bit set groupid bit set perm  specifies match  bit speci fied octal number set file per mission mode setgroupid bit printthis indicates file match specified expression regular file setuid setgid bit set permission print name screen executing command depending much disk space take anywhere minute couple hour complete list file setuid setgid bit set examine program determine whether actually permission especially suspicious program one directory subdirec tory shown bin etc usrbin usrucb usretc one file distributed sunos usretcrestore dis tributed setuid bit set security hole sure remove setuid bit program executing command chmod u usretcrestore  finding worldwritable file worldwritable file particularly system file security hole cracker gain access system modi fies additionally worldwritable directory dangerous since allow cracker add delete file wish find command find worldwritable file find perm  print case use type option restrict search since interested directory device well file  specifies world write bit octal list file fairly long include file world writable con cerned terminal device dev world writable also concerned line printer error log file world writable finally symbolic link may world writ able permission symbolic link although exist meaning  finding unowned file finding file owned nonexistent user often clue cracker gained access system even case searching file give opportunity clean file deleted time user deleted command find unowned file find nouser print nouser option match file owned user id contained etcpasswd database similar option nogroup match file owned nonexistent group find file owned nonexistent user group would use option follows find nouser nogroup print  finding rhosts file mentioned section  user prohibited rhosts file account search necessary search part file system contain home directory ie skip usr find home name rhosts print name option indicates complete name file whose name match rhosts printed screen  checklist checklist useful tool discovering unauthorized change made system directory nt practical file system contain user home directory since change time checklist listing file contained group directory size owner modifi cation date periodically information col lected compared information master checklist file match attribute suspected changed several utility implement checklist avail able public software site see section however sim ple utility constructed using standard unix l diff command first use l command suna generate master list best done immediately installing operat ing system done time provided confident correctness file disk sample command shown l aslgr bin etc usr masterchecklist file masterchecklist contains complete list file directory probably want edit delete line file know changing often eg etcutmp usradmacct masterchecklist file stored somewhere safe cracker unlikely find since could otherwise change data either different computer system magnetic tape search change file system run l command saving output file say currentlist use diff command suna compare two file diff masterchecklist currentlist line master checklist printed pre ceded  line current list preceded  one line file preceded  mean file deleted since master checklist created one line file preceded  mean file created since master checklist created two line single file one preceded   indicates attribute file changed since master checklist created carefully constructing master checklist remembering update periodically replace copy currentlist sure difference list harmless easily monitor system unau thorized change software package available pub lic software distribution site implement basically scheme one offer many option control ling examined reported  backup impossible overemphasize need good backup strategy file system backup protect even hardware failure accidental deletion also pro tect unauthorized file system change made cracker good backup strategy dump entire system level zero full  dump least month partial incremental  dump done least twice week ideally done daily dump command suna  recommended program tar cpio dump capable creating backup used restore disk exact state dumped program take account file deleted renamed dump handle specialized database file properly  know system aside running large monitoring program described previous section simple everyday unix command also useful spotting security violation running command often whenever free minute exam ple waiting someone answer phone become used seeing specific pattern output familiar process normally running system time different user typically log easily detect something ordinary  p command p command suna  display list process running system p numerous option many list generally however purpose moni toring option string alxww useful sun system running sunos  expect see least following swapper pagedaemon system program help virtual memory system sbininit init process responsible numerous task including bringing login process termi nals portmap ypbind ypserv part yellow page system biod nfsd rpcmountd rpcquotad rpclockd part network file system nfs system looking file server nfsd process probably wo nt exist rarpd rpcbootparamd part system allows diskless client boot command expect see update file system updater getty one per terminal one  true berkeleybased system system v sys tems option string elf used instead console lpd line printer daemon inetd internet daemon starting network server sh csh bourne shell c shell one per logged user addition user logged probably see invocation various compiler text editor word processing program  w command command mentioned previously display list user currently logged system running periodically learn time day various user log see someone logged dif ferent time investigate make sure legiti mate w command suna somewhat cross p show list presently logged also display long idle gone without typing anything command currently running  l command simple function l actually useful detecting file system problem periodically use l various system directory checking file nt time file landed  somewhere accident however keeping close watch thing able detect cracker long might otherwise using l check oddity sure use option list file whose name begin period particularly alert file directory named    space  many cracker like use course remember    supposed  keep eye open monitoring security breach every bit important preventing first place virtually impossible make system totally secure always chance matter small cracker able gain access monitoring detected remedied section software improving security security great concern many site wealth software developed improving security unix system much software developed universi tie public institution available free asking section describes software obtained mention important program avail able  obtaining fix new version several site internet maintain large repository publicdomain freely distributable software make material available anonymous ftp section describes larger repository  sun fix uunet sun microsystems contracted uunet communication service inc make fix bug sun software available via anonymous ftp access fix using ftp command suna  connect host ftpuunet change directory sunfixes obtain directory listing shown example following page ftp ftpuunet connected uunetuunet uunet ftp server version  tue mar  est ready name ftpuunet davy anonymous guest login ok send ident password password enter mail address yourname yourhost guest login ok access restriction apply ftp cd sunfixes  cwd command successful ftp dir port command successful opening ascii mode data connection binls total rwr  r  aug readme rwr  r  dec ddntarz rwr  r  jan gatedsunz rwxrxrx dec inftpdsunz     rwr  r  aug sendmailsunz rwxrxrx aug sendmailsunz rwr  r  jul wallsunz rwr  r  jul wallsunz rwxrxrx jan ypbindsunz rwxrxrx jan ypbindsunz transfer complete byte received  second  kbytess ftp quit  goodbye file readme contains brief description file directory contains required install fix  berkeley fix university california berkeley also make fix available via anonymous ftp fix pertain primarily current release bsd unix currently release  however even running software fix still important since many vendor sun dec sequent etc base software berkeley release berkeley fix available anonymous ftp host ucbarpaberkeleyedu directory ucbfixes file index directory describes file contains berkeley also distributes new version sendmail named suna   machine new version command stored  directory usually file sendmailtarz bindtarz respectively  simtel uunet two largest generalpurpose software repository internet host wsmrsimtelarmymil ftpuunet wsmrsimtelarmymil top machine operated u army white sand missile range new mexico direc tory pd unixc contains large amount unix software pri marily taken compsources newsgroups file  masterindextxt contains master list description piece software available repository file  introunixswtxt contains information mailing list used announce new software describes procedure used transferring file archive ftp ftpuunet operated uunet communication service inc fall church virginia company sell internet usenet access site country internation ally software posted following usenet source news group stored directory name compsourcesgames compsourcesmisc compsourcessun compsourcesunix compsourcesx numerous distribution freely distribut able berkeley unix source code internet request comment rfcs also stored machine  vendor many vendor make fix bug software available electronically either via mailing list via anonymous ftp contact vendor find offer service access vendor offer service include sun microsystems see digital equipment corp university california berkeley see apple computer  npasswd command npasswd command developed clyde hoover university texas austin intended replacement standard unix passwd command suna well sun yppasswd command suna npasswd make password secure refusing allow user select insecure pas word following capability provided npasswd configurable minimum password length configurable force user use mixed case digit punctuation checking simple  password repeated letter checking host name hostspecific information checking login name first last name checking word various dictionary including system dictionary npasswd distribution available anonymous ftp emxutexasedu directory pubnpasswd  cop package cop security tool system administrator check numerous common security problem unix system including many thing described document cop collection shell script c program easily run almost unix variant among thing check following item sends result system adminis trator check devkmem device world readwritability check specialimportant file directory bad  mode world writable etc check easily guessed password check duplicate user id invalid field password file etc check duplicate group id invalid field group file etc check user home directory cshrc login profile rhosts file security prob lem check command etcrc file suna  cron file suna  world writability check bad root  path nfs file system exported world etc includes expert system check see given user usually root  compromised given certain rule true check change setuid status program system cop package available compsourcesunix archive ftpuunet also repository wsmr simtelarmymil  sun c security feature release sunos  sun included security feature allow system operate higher level security patterned c classification feature installed one option installing system distribution tape security feature added option include audit trail record login logout time execution administrative command exe cution privileged setuid operation secure password file mechanism shadow pas word file  prevents cracker obtaining list encrypted password  c one several security classification defined national computer security center described ncsc orange book  de encryption capability secure nfs implementation us publickey encryption authenticate user system host network sure really claim security feature described detail sunc  kerberos kerberos stei authentication system developed athena project massachusetts institute technology kerberos thirdparty authentication service trusted network service user log kerberos authenticates user using password provides user way prove identity server host scat tered around network authentication used program rlogin suna  allow user log host without password place rhosts file authenti cation also used mail system order guarantee mail delivered correct person well guarantee sender claim nfs also modi fied mit work kerberos thereby making system much secure overall effect installing kerberos numerous program go virtually eliminate ability user spoof  system believing someone else unfortunately installing kerberos intrusive requiring modification replacement numerous standard program reason source license usually necessary plan make kerberos part bsd released university california berkeley sometime section keeping abreast bug one hardest thing keeping system secure finding security hole cracker combat several source information make use regular basis  computer emergency response team computer emergency response team cert established december defense advanced research project agency address computer security concern research user internet operated software engineering institute carnegiemellon university cert serf focal point reporting security violation dissemination security advisory internet community addition team work vendor various system order coor dinate fix security problem cert sends security advisory certadvisory mailing list whenever appropriate also operate hour hotline called report security problem eg someone breaking system well obtain current accurate information rumored security problem join certadvisory mailing list send message cert certseicmuedu ask added mailing list past advisory available anonymous ftp host certseicmuedu hour hotline number   ddn management bulletin ddn management bulletin distributed electronically defense data network ddn network information center contract defense communication agency mean communicating official policy procedure information concern management personnel ddn facility ddn security bulletin distributed electronically ddn scc security coordination center also contract dca mean communicating information network host security exposure fix concern security management personnel ddn facility anyone may join mailing list two bulletin sending message nic nicddnmil asking placed mailing list  securityrelated mailing list several mailing list operated inter net pertain directly indirectly various security issue useful one described  security unix security mailing list exists notify system administrator security problem become common knowledge provide security enhancement information restrictedaccess list open people veri fied principal system people site request join list must sent either site contact listed network information center whois database root  account one major site machine must include destination address want list indica tion whether want mail reflector list receive weekly digest electronic mail address voice telephone number site contact nt name address telephone number organization information sent securityrequest cpdcom  risk risk digest component acm committee com puters public policy moderated peter g neumann discussion forum risk public computer related system along discussing computer security privacy issue discussed subject stark incident shooting iranian airliner persian gulf relates computerized weapon system problem air railroad traffic control system software engineering join mailing list send message risk request cslsricom list also available usenet newsgroup comprisks  tcpip tcpip list intended act discussion forum developer maintainer implementation tcpip pro tocol suite also discus networkrelated security problem involve program providing network service sendmail join tcpip list send message tcpip request nicddnmil list also available usenet newsgroup compprotocolstcpip  sunspot sunnets sunmanagers sunspot sunnets sunmanagers list dis cussion group user administrator system supplied sun microsystems sunspot fairly general list dis cussing everything hardware configuration simple unix question subscribe send message sunspot request riceedu list also available usenet newsgroup compsyssun sunnets discussion list item pertaining net working sun system much discussion related nfs yellow page name server subscribe send me sage sunnetsrequest umiacsumdedu sunmanagers discussion list sun system administra tor cover aspect sun system administration subscribe send message sunmanagersrequest eecsnwuedu  virusl virusl list forum discussion computer virus experience protection software related topic list open public implemented mail reflec tor digest information related per sonal computer although may applicable larger system subscribe send line sub virusl full name address listserv lehiibmbitnet mitvmamitedu section suggested reading section suggests alternate source information pertaining security administration unix operat ing system unix system administration handbook evi nemeth garth snyder scott seebass prentice hall  perhaps best generalpurpose book unix system administration currently market cover berkeley unix sunos system v chapter appen dice cover numerous topic including booting shutting system file system configuring kernel adding disk line printer spooling system berkeley networking sendmail uucp particular interest chapter running superuser backup security unix operating system security f grammp r h morris bell laboratory technical journal october excellent discussion common security problem unix avoid written two bell lab prominent security expert password security case history robert morris ken thompson communication acm november excellent discussion problem password security interesting information easy crack password document usually reprinted vendor unix documentation security unix dennis ritchie may discussion unix security one original crea tor system document usually reprinted vendor unix documentation cuckoo egg clifford stoll doubleday  excellent story stoll experience tracking german cracker breaking system sel ling data found kgb written level nontechnical user easily understand system network administration sun microsystems may part sunos documentation manual cover aspect sun system administration including security issue must anyone operating sun system pretty good reference unix system well security problem tcpip protocol suite bellovin acm computer communication review april interesting discussion security problem protocol use internet elsewhere problem far beyond capability average cracker still important aware article technical nature assumes familiarity protocol weakness bsd unix tcpip software robert morris bell lab computer science technical report february interesting article author internet worm describes method allows remote host spoof  host believing trusted article technical nature assumes familiarity protocol computer virus related threat management guide john p wack lisa j carnahan national institute standard technology special publication  document provides good introduction virus worm trojan horse explains work used attack computer system written nontechnical user good starting point learning security problem document ordered  u government printing office document number  section conclusion computer security playing increasingly important role life operation become computerized computer network become widespread order protect system snooping vandalism unauthorized crack er necessary enable numerous security feature provided unix system document covered major area made secure account security network security file system security additionally discussed monitor security vio lations obtain securityrelated software bug fix numerous mailing list finding security prob lem discovered many cracker interested breaking specific system rather break system vulnerable attack know eliminating wellknown hole monitoring system security problem usually serve adequate defense determined cracker using procedure source described document make system secure reference eich eichin mark w jon rochlis microscope tweezer analysis internet virus november  massachusetts institute technology february elme elmerdewitt philip kid put u action  time november gram grammp f r h morris unix operating sys tem security  bell laboratory technical jour nal  october hind hinden r j haverty sheltzer darpa internet interconnecting heterogeneous computer net work gateway  ieee computer magazine  september mcle mclellan vin nasa hacker story  digital review november p morr morris robert ken thompson password security case history  communication acm  november reprinted unix system manager manual  berkeley software distribution university california berkeley april ncsc national computer security center department defense trusted computer system evaluation criterion department defense standard dod std december quar quarterman j j c hoskins notable com puter network  communication acm  october reed reed j p j weinberger file security unix system crypt command  bell labora tory technical journal  october risk forum risk public computer related system acm committee computer public policy peter g neumann moderator internet mailing list issue  december risk forum risk public computer related system acm committee computer public policy peter g neumann moderator internet mailing list issue  december riska forum risk public computer related system acm committee computer public policy peter g neumann moderator internet mailing list issue  january riskb forum risk public computer related system acm committee computer public policy peter g neumann moderator internet mailing list issue  january risk forum risk public computer related system acm committee computer public policy peter g neumann moderator internet mailing list issue  february ritc ritchie dennis security unix  may reprinted unix system manager manual  berkeley software distribution university califor nia berkeley april schu schuman evan bid unhook worm  unix today february p seel seeley donn tour worm department com puter science university utah december spaf spafford eugene h internet worm program analysis technical report csdtr department computer science purdue university november stee steele guy l jr donald r wood raphael finkel mark r crispin richard stallman geoffrey goodfellow hacker dictionary new york harper row stei stein jennifer g clifford neuman jeffrey l schiller kerberos authentication service open network system  usenix conference proceeding dallas texas winter pp  stol stoll clifford stalking wily hacker  commun ications acm  may stol stoll clifford cuckoo egg new york double day suna sun microsystems sunos reference manual part number  may sunb sun microsystems system network administration part number  may sunc sun microsystems security feature guide part number  may sund sun microsystems network file system version protocol specification  network programming part number  may pp  appendix security checklist checklist summarizes information presented paper used verify implemented every thing described account security password policy developed distributed user password checked obvious choice expiration date account idle  guest account account password  password field group account  line passwd group checked running yellow page network security hostsequiv contains local host  rhosts file user home directory local host root  rhosts file console  labeled secure  ttytab server terminal labeled secure  ttytab client nfs file system exported world ftpd version later december decode  alias alias file wizard  password sendmailcf debug  command sendmail fingerd version later november modem terminal server handle hangups correctly file system security setuid setgid shell script check nonstandard  setuid setgid program security setuid bit removed usretcrestore sticky bit set worldwritable directory proper umask value root  account proper mode device dev backup level dump least monthly incremental dump least biweekly page intentionally left blank throw lxiv content introduction                unix security                internet worm               spy espionage              breakins               security important            improving security              account security               password                 selecting password  password policy  checking password security  expiration date               guest account                account without password            group account group            yellow page                network security               trusted host                hostsequiv file  rhosts file  secure terminal               network file system             export file  netgroup file  restricting superuser access  ftp                   trivial ftp  mail                   finger                  modem terminal server           firewall                 file system security              setuid shell script              sticky bit directory           setgid bit directory           umask value               encrypting file               device                  security responsibility         monitoring security              account security               lastlog file               utmp wtmp file             acct file                network security              iii content continued  syslog facility              showmount command             file system security             find command               finding setuid setgid file  finding worldwritable file  finding unowned file  finding rhosts file  checklist                 backup                  know system               p command               w command             l command               keep eye open             software improving security          obtaining fix new version         sun fix uunet              berkeley fix               simtel uunet              vendor                  npasswd command              cop package               sun c security feature            kerberos                keeping abreast bug           computer emergency response team        ddn management bulletin            securityrelated mailing list          security                 risk                  tcpip                  sunspot sunnets sunmanagers         virusl                 suggested reading             conclusion               reference                  appendix security checklist           iv v   pm still   pm respond logged  end session disconnected e   kdl z carrier 