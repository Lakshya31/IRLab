holelist v wed apr  mdt operating system description reference                     bsd  mail directly file bsd  exec sgid program dump core core sgid bsd  lock  compiled password  hasta la vista  bsd  ifs w preserve bug wvi bsd  suspend mkdir ln file want dir bsd  lock  compiled password  hasta la vista  bsd  ln passwd file mail spool mail user file bsd  truncate read file bsd  finger  stringbinrm f etcpasswd  foobar bsd  ln target plan finger user read file bsd  lpr file rm file ln anyfilename file bsd  adb su change check memory shell bsd  race condition get root via   bsd  ftp n quote user ftp cd root get root priv bsd  lpd overwrite file bsd  ln anysuidfile get suid shell bsd  fchown chown file bsd  race condition expreserve root via   bsd  passwd choke long line split pw file  tahoe chfn  allows newlines meta char bufsize  tahoe login ttya b cat ttyb z b exit login b pwuid get pw overwrite get buffer  fingerd etc uudecode alias overwrite rootdaemon file binmail binsh get uidbin shell rwall bug adb running kernel shell get root mail nonroot owned file try twice rshd spoof via nameservice  rsh target l uid sunos login n root password sunos  connect wacct user root l put tmpf tmpb sunos  chsh similar chfn sunos x anyone restore file file sunos x chfn  allows newlinesmeta char bufsize sunos x rcp uid  pcnfs sunos x ln anysuidfile get suid shell sunos x selection service remotely grab file sunos  mail nonroot owned file try twice sunos  login ttya b cat ttyb z b exit login b pwuid get pw sunos  shared libs accept relative path w suid sunos  rshd spoof via nameservice rsh target l uid sunos adb running kernel shell get root sunos ftp n quote user ftp ect get root privs sunos symlink plan target file finger user sunos overwrite get buffer  fingerd etc  sunos rwall bug  yes sunos lpd overwrite file sunos window manager used read file sunos rexd  get root access enabled sunos  rcp buffer overflow aix rexd  get root access enabled sunos x comsat overwrite file sunos x ptrace allows become root sunos x openlook telnet executive x run p int ultrix  ln passwd file mail spool mail user ultrix  get root nfs host via root via mountd dynix  get root nfs host via root via mountd ultrix  lock  compiled password  hasta la vista  ultrix  user mount filesystem ultrix  login run program root privs ultrix  x nt clear password mem devmem ultrix  ln target plan finger user access ultrix  rshd spoof via nameservice rsh target l uid ultrix  limit file passwd  zero passwd file ultrix  lpd overwrite file back  ultrix  overflow risc register buffer get root w mail ultrix chfn  allows newlines meta char bufsize ultrix ftp n quote user ftp ect get root privs ultrix change host name mount filesystem ultrix uudecode alias overwrite rootdaemon file sysv ifs environment  login  prompt sysv write file race condition using mkdir ln sysv  expreserve problemrace condition irix rsh host l   command run root stellix  rsh host l   command run root irix login r hostname ruser luser term dynix login r hostname ruser luser term irix login r hostname ruser luser term hpux  chfn  allows newlines etc hpux  chfn  allows newlines etc new bug domainos  break root using srbak setgiduid amdahl ut  nfs mountd us hostname authentication sco rlogin acct trusted host wo passwd belltech sysv ulimit passwd  zero passwd file microport  ulimit passwd  zero passwd file sunos  user run yp server sunos  ypbindypserv sunos  need machine sunos  ypbindypserv sunos  need machine sunos  concurrent yppasswd session trash yp map sunos  ypserv sends map anyone domainame ypsnarf ultrix  allows newlines meta char buffsize problem ultrix yppasswd leaf yp data file world writable ultrix ypbind take ypset anyone play yp db server bsd  sendmail mail directly file sunos  sendmail mail directly file sendmail  mail file root owned try twice  sendmail group incorrectly checked get group sunos  sendmail group incorrectly checked get group ultrix  sendmail c file  display file dynix  sendmail c file  display file ultrix  sendmail version   sm oq readwrite hpux sendmail version   sm oq readwrite sendmnail   binrm etcpasswd  bounce mail  irix  sendmail user read user mail wiz shell get root shell xr snoop keyboard bitmap xr set log execute command fixed  fix  sun  uucico show ph num login passwd remote machine sunos icmp error handled correctly log user remotely ultrix icmp error handled correctly log user remotely sunos emacsclientserver allows access file ultrix emacsclientserver allows access file  general  allow usernames contain following character   shell metacharaters allows setuid root program popen spoofed never allow setuid root program send mail message user creates either berkeley mailer mailx user break root send line cp binsh tmpsh chmod tmpsh berkeley mail berkeley mailx allow shell escape executed line start column one stdout entering message text security hole unix related incorrect setting directory file permission race condition kernel allow setuid program exploited nonstandard setuid program examined many system compromised nfsrpc skilled rpc writer break security relatively easily mit project athena came kerberos address problem network usually insecure mount command executeable ordinary user setuid program mountable disk trusted system allow readonly mounting foriegn disk security hole setuid program normally honored allows person root access foriegn machine break another expreserve huge hole see following devfb frame buffer device least sun world readablewriteable best annoying someone run something strange worst insecure since someone take snapshot screen via screenload whatnot devst mt etc tape device generally world readablewriteable bad since others nuke tape read backup etc chfn chsh used create root account core system dump setgid core image domain name system sysadmin running soa domain somewhere create bug reverse address mapping table one host cause ip address domain name machine host hostsequiv file using usual version istrusted think thats routine name address lookup reveals name host one host trust sysadmin rlogin machine rsh whatnot fchown test bad group test ftruncate used change majorminor number device fingerd hard plan link reading unreadable file readable user fingerd setuid plan link running root fingerdtestsh buffer overrun file mod test test file loose setuid bit modified ftp ftpd static passwd struct overwrite  based bug userid reset properly logging enter comment  user root  last seen onder sunos  overwrite stack somehow hostsequiv default entry istrusted routine easy spoof bad soa remote site hacked reverse address map lock bsd version password  hasta la vista  builtin trapdoor found ultrix lostfound fsck lostfound mode else others might see private file lpd possible ovberwrite file root authority user level access locally remotely local root access lpr lpr r access testing problem lprm trust utmp passwd fgets use allows long entry mangled  entry also allows fred    fred  flintstone binsh fred    fred   flintstone binsh root entry password fix skip eol nt read whole entry enforce buffer limit text file nt use atoi since atoi binsh portmap allows net entity make binding may  security hole  lead denial service rcp nobody problem rexd existence rwall comsat running root utmp world writeable writes file well device utmp dev field rdist buffer overflow selectionsvc allowed remote access file sendmail debug option wizard mode turn command allows mail stolen decode mail alias anyone send mail decode write file onwed daemon connect sendmail daemon write file owned user overflow input buffer cause sendmail deamon lock overwrite file sendmail  tricked  delivering mail file root oq different q fixed newer version mqueue must mode uid program run sendmail bt cusrspoolmailuser old version allows see line file setuid bit handling setuidsetgid bit dropped file modified fix kernel change setuid script several problem setuid script worth writing test system might fixed hole anyone know one fix problem proactive fashion sh ifs hole used vi anything else su overwrite stack somehow tcpip sequence number prediction make host spoofing easier source routing make host spoofing easier rip allows one capture traffic easily various icmp attack possible suspect traceroute kernel allow one easily dump packet onto ethernet tftp allows one grab random file eg etcpasswd fix chroot allows put well get chroot fix nt run root use chroot put boot server utmp check see world writeable data ca nt trusted although program written though trust data comsat rwalld uucp check valid uucp account etcftpusers shell uucico passwd valid make sure listed ftpusers check see uucp account shell left folk cat x myhost myname uucp x uucprhosts rsh myhost l uucp sh hdb nostrangers shell escape hdb changing owner set uidgid file hdb meta escape x command line hdb break x line uudecode setuid version create setuid file ypbind accepts ypset anyone create ypserv data ypset  ypserv spoofing send lot bogus reply request root passwd entry something would generate request pretty sure possible nt tried aix password mean use root password aix  shadow password file etcsecuritypasswd world writeable fix chmod  login fix nuke logintool hack login adb chmod ultrix  login login p progname allows one run random program root fix chmod  xhost access access control disabled one connect x display possible create forge andor intercept keystroke  general  allow usernames contain following character   shell metacharaters allows setuid root program popen spoofed never allow setuid root program send mail message user creates either berkeley mailer mailx user break root send line cp binsh tmpsh chmod tmpsh berkeley mail berkeley mailx allow shell escape executed line start column one stdout entering message text security hole unix related incorrect setting directory file permission race condition kernel allow setuid program exploited nonstandard setuid program examined many system compromised nfsrpc skilled rpc writer break security relatively easily mit project athena came kerberos address problem network usually insecure mount command executeable ordinary user setuid program mountable disk trusted system allow readonly mounting foriegn disk security hole setuid program normally honored allows person root access foriegn machine break another expreserve huge hole see following  bsd  earlier bsd release  following security hole exists bsd  flavor unix bug associated usrlibexpreserve setuid root shell ifs internal field seperator variable expreserve executes line fp popen  binmail user   w  null  implementation popen c exec call form execl  binsh   sh   c  popenarg char binsh telling run command sh c  binmail user  shell running effective user id root change ifs caused shell parse command  bin mail user  executes shell script  bin  current directory copy version c shell make setuid root sighup ex cause expreserve invoked preserve user editing session send user mail telling copy buffer saved etc etc fix accomplished sh ifs processing argument following  c  option mkdir cd touch bin chmod arx bin set path path cat bin endofile bincsh f setenv ifs bincp bincsh binchmod u csh endofile setenv ifs ex bin  bin  lll line ccc character sccc binccsh f stop stoppedex bin kill hup ex wait l l csh rwsrxrx root jan csh csh work bsd fixed bsd  sys v earlier release  following work work svr usg earlier release long create file file system etcpasswd race condition binmkdir mkdir first mknod directory chown directory real uid process mknod dir sifdir  chown dir getuid getgid context switch mknod call parent process unlink node creates link mkdir process run binmkdir chown link owned many system tmp file system otherwise file need located compromised caused lack mkdir system call binmkdir setuid root work assuming tmp file system etc one could would invoked like following breakdir etcpasswd tmpfoo would change uid root  svr svr  several extremely nasty bug cron run atjobs run setuid root normally atjobs stored usrspoolcronatjobs creates file owned atjob submitter many system usrspoolcronatjobs mode drwxrxrx allows normal user chdir directory many system v crons determine uid run atjob file owner breaking security simple cding cron change owner atjob submitted root alternatively atjob submits another atjob system run root nt know  bsd  earlier sysv sunos sometimes  well folk found rather barbaric race condition expreserve allows setuid program compromised changing permission file bug exists expreserves including berkeley  well quite system v earlier release work system v expreserve place ex temp file directory usrpreserve user berkeley release place either usrpreserve varpreserve sun x  feature  definitely allow security breached standard system v nonsecured berkeleyish system usrpreserve writeable user note sunos directory unwriteable system v bug relatively unavoidable svr berkeley bug fixed soon fchown system call added bsd basically  hole  expreserve fd creat  usrpreserveexaaa pid chown  usrpreserveexaaa pid realuid realgid fd creat  usrpreserveexaaa pid fchown fd realuid realgid avoids race change permission inode creat ed inode whose name usrpreserveexaaa pid previous example actually simplified expreserve actually look uid gid stored tmpex pid file compare getuid getgid return value actual  race  context switch may occur creat chown expreserve allows another process write permission target directory unlink creat ed file place hard link another file name target directory expreserve subsequentlies chown uid  feature  allows file device owned reading symbolic link also work symlinks atleast sunos x hpux according bsd programmer reference manual chown change permission file pointed symlink one failure condition eloop many symbolic link encountered translating pathname implies chown symbolic link chown file pointed link sunosx hpux ab change permission symbolic link funny thought symlinks always mode lrwxrwxrwx man page sunos hpux also include eloop failure condition chown bug usable place trojan horse  trusted  directory eg usrbin trojan horse would place program fork exec program giving setuid root shell euid equal root exec real program restores everything procedure utilizing bug create valid nonzero length tmpex pid file copy directory cracking program located name  data  edit junk file make change escape shell check tmp directory nonzero length ex pid file owned copy cracking directory run program follows note program need modified run system v support usrpreserve userexaaa pid target tested sunos x hpux nt time modify yet definitely work system v four way gain unauthorized root privilege knowing root password easy prevent using setuid program even case configuration error like mode passwd file unauthorized privilege granted system suid program like login passwd etc bad system call issue older version instance setgid  strange thing old unix version nt really happen anymore fooling daemon running root largest problem editing crontab playing sendmail fall category also network misused instance write program talk ypserv nfsd anything also daemon use configuration file nt readable security violation occur due bad file protection exploited normal command c source code another problem old bugged program particular setuid program daemon hacker nt use source code think hacker us source exploit problem impossible find search pattern deterministically state program good bad wabbit bug year ftp server wabbit bsd wabbit  bug reference sheet comfirmations addition change df certseicmuedu last change made dec x bsd version problem            mail directly file run set gid program dump core set gid owner lock  compiled password  hasta la vista  plus z pre  ifs w preserve bug vi suspend mkdir ln file want dir file  lock  compiled password  hasta la vista  ln passwd file mail spool mail user  file truncate read file finger  string binrm f etcpasswd  foobar ln target plan finger user read file lpr file rm file ln anyfilename file  print file adb su change check memory shell su  root race condition get root via    ftp n quote user ftp ect get root privs lpd overwrite file ln anysuidfile get suid shell fchown chown file race condition expreserve get root via   passwd choke long line split pw file  root access  tahoe chfn  allows newlines meta char bufsize problem login ttya b cat ttyb z b exit login b pwuid got b pw overwrite get buffer  fingerd etc uudecode alias overwrite rootdaemon owned file binmail binsh get uidbin shell rwall bug adb running kernel shell get root sendmail mail nonroot owned file try twice rshd  spoof via nameservice rsh target l uid sunos version problem           login n root requires password  ftp  connect w acct user root l put tmpfoo tmpbar result owned root   chsh  similar chfn x anyone restore file file chfn  allows newlines meta char bufsize problem rcp uid  pcnfs ln anysuidfile get suid shell selection service remotely grab file  sendmail mail nonroot owned file try twice login ttya b cat ttyb z b exit login b pwuid got b pw  shared libs accept relative path running suid eg xterm rshd  spoof via nameservice rsh target l uid adb running kernel shell get root ftp n quote user ftp ect get root privs symlink plan target file finger user read overwrite get buffer  fingerd etc  rwall bug  yes lpd overwrite file window manager used read file rexd  get root access enabled  rcp buffer overflow  comsat overwrite file ptrace allows become root openlook telnet port executive x run p interp ultrix version problem            ln passwd file mail spool mail user  file get root host running nfs root account nontrusted host due bug mount daemon dynix  also  lock  compiled password  hasta la vista  user mount filesystem login run program root privs x nt clear password memory devmem world readable ln target plan finger user read file  limit file passwd  zero passwd file lpd overwrite file back   overflow risc register buffer get root mail chfn  allows newlines meta char bufsize problem ftp n quote user ftp ect get root privs change host name mount filesystem uudecode alias overwrite rootdaemon owned file  rshd  spoof via nameservice rsh target l uid system v version problem           set ifs environment  login  prompt svr expreserve problemrace condition pre svr write file race condition using mkdir ln sgi iris mips steller              stellix  rsh host l   command run root riscos  dynix stellix  login r hostname ruser luser term hpux version problem            chfn  allows newlines etc different bug  apollo version problem           x max break root using srbak problem setgiduid amdahl ut version problem            nfs mountd us hostname authentication easy spoof sco version problem           rlogin acct root etc trusted host wo password bell tech sys v           microport  ulimit passwd  zero passwd file yp           pre  user run yp server  ypbindypserv sunos  need machine  concurrent yppasswd session trash yp passwd map ypserv send map anyone guess domainame ultrix allows newlines meta char buffsize problem yppasswd leaf yp data file world writable ypbind take ypset anyone say yp db server sendmail            bsd mail directly file sun   mail file root owned try twice  sun lot others group incorrectly checked get group ultrix  dynix  c file  display file ultrix  hpux version   sm oq  readwrite file   binrm etcpasswd  bounce mail  irix  user read user mail wiz shell get root shell x           xr snoop keyboard bitmap xr set log execute command fixed  fix  uucp           sun  uucico show ph num login passwd remote machine tcpip           icmperror error handled correctly log user remotely misc           gnuemacs emacsclientserver allows access file still need type see add  ultrixlst mike burrow burrow srcdeccom  berkeley  maybe also  sun ultrix  get root shell standard sendmail typing wizard password wiz  shell  fixed  chfn chsh rename tmp lock file etcpasswd fflushing window passwd file null unlocked running one right another zap passwd file hit timing hole chfn allows put massive field passwd file break getpwent passwd leaf passwd file locked user set file size limit running programme passwd chfn chsh etc nt detect corrupt pw entry add new one particularly one null name passwd zero uid su   work without password lpr print file use flag ca nt copy rename file fixed  lpr remove file r option luckily wo nt remove unix image refuse print aout ptrace modifies shared text modify text readable binary incore allows immediate breakin suid progs writing short c prog even using adb set break point stop one using given programme vi run expreserve huped expreserve suid run sh c  binmail   similar fun ifs seen lot system ultrix system sun devkmem devmem readable  open system even provide unprivileged utility core dump process recompile security check removed patch binary ioctl tiocsti simulate terminal input controlling tty fine set controlling tty anything using ioctl tiocnotty fixed  send sigint sighup sigquit sigtstp process system changing tty process group group target process hitting intr logging hitting quit hitting susp fixed  sun system window display etcutmp publicly writable window system put pty make easy fake userid anything belief getlogin suid shell script run profile file make link name suid shell script never allowed reason anyway eg ifs similarly csh ultrix physical ethernet address machine changed user denial service berkeley network security based  reserved port  therefore trivial break workstation vhangup system call meant disconnect process current controle terminal however reopen terminal devtty even tty permission changed since controle tty zeroed suid programme nt expect resource usage signal timeout signal system generic general bug  version uusend call  uux  path suid root news receiver execute shell command sent news feed nfs exec permission equivalent read general nfs protection lousy ethernet nonexistent took minute work one undergraduate understand construct send packet delete file using nfs informationguest logins release userids user write trojan horse lssu programme fix change default path bin usrbin fix shell wo nt exec relative path unless directory writable user important progs like  su  could require argv binsu bogus gettylogin fix line come network interface port accessed anyone root terminal driver hardwired escape eg line break always zap process terminal open see vhangup idle logout help thing little insecure reboot fix use b pity b unusable single user mode spawn binlogin many daemon andor support programme insecure invoked directly user often mail forged way fix stop normal user execing progs root suid programme dont suid root many mail system keep user mail file readable user also keep temp file readable others password significant longer eight character passwd warn character lost system popen never called suid programme programme ever called suid programme even version system say setuid getuid lot hole programme nt give uid random programme acting information given random programme version rmdir broken system without rmdir syscall allows remove  net bugfix similar problem rm r mv mvdir script crypt weak trusted anyone average c student break manual say better encryption scheme provided wheeler encryption faster software secure system tty generally writable write suid allow arbitrary controle character also possible user force write die cf hanging phone even console generally writable logging block otherwise eg user make console run paper send interesting controle code getlogin ttyslot ttyname nt finduse controlling terminal use stdin instead sometimes used security check useless security check lot  denial service  bug due lax resource allocation easy hog processor memory disc tty bandwidth advisory lock seperate permission bit easy lock daemon us file used locking read write permission  others  suid programme nt expect get filesize limit signal sigalrms  known security hole unix system hp confidential last updated list collected alan silverstein security problem listed correctable site unless noted   sensitive left margin  sanitized  version list line removed list incomplete please send addition correction  sanitized  list also generalized hpux generic unix basic principle good security physical control equipment management committment security employee education expected administrative procedure designed increase security concealment alone security better know secure falsely think hardware anyone connect root disc another system mount break security anyone mount personal volume local system init state start shell without going login anyone reboots system superuser solution physical security removable mass storage volume protected mount command init state requires login file system sloppy ownershipspermissions common problem particularly special file solution sure filesystem generally secure special file like devmem devkmem devrhd even readable except superuser use default umask see sh new file writable except owner root directory must unwritable owned root unprotected user move etc create etcpasswd file solution protect root directory comment pre version sdfinit series left new volume set necessary  l ld  check public directory general must owned root set unwritable particular etc usr usrlib superuser login directory sensitive due system config profile file solution deny write access public directory except need exists tmp configuration file certain file must owned root package owner like news lp unwritable public including etcinittab etcrc etcpasswd etcgroup etcprofile usrlibcrontab superuser profile solution deny access sensitive file except need exists command path shell script program use exec may violated trojan horse run superuser user particular user might call setuid program bogus path variable exported solution shell script certain program set path running command use explicit absolute path andor require invoked using absolute path like binsu privilegeduser path superuser user path variable includes   null field  current directory  user change nonsecure directory might unknowingly run trojan horse program named standard command program might create setuidsetgid shell remove solution avoid  current directory  path command require invoked absolute path keep file system sufficiently secure nonprivileged user plant trojan horse library command comment one possibility shell check ownership file running command found directory path start   owned user trying run give error forcing user type   run setuid suid command program owned root privileged group set run superuser user group lead trouble allowing shell escape privileged shell appending protected file dumping writable setuid core file etc particular mount dangerous set system removable mass storage device user mount volume containing superuser shell solution minimize use setuidsetgid deny access setuidsetgid program except need exists program checked hole sure setuidsetgid command writable able account setuidsetgid program system andor check periodically program must setuid getuid setgid getgid shell escape chown must turn set bit ownership changed setuid suid script file begin  command  direct execution command exec setuid setgid may tricked unforeseen side effect running  command  example script readable shell script  binsh  linked anyone file named  sh  merely exec arg  sh  shell run setuid leading   name cause read etcprofile worse user profile starting bsd name   get interactive prompt solution disallow setuidsetgid script execution exec disallow linking file sufficient modify potentially scripted command avoid problem note command understand   style comment even candidate scripting terminal access unattended loggedin terminal asking trouble terminal whose special file readable user subject data stolen solution log lock using internal command lock terminal use make terminal special file readable public  parked  trojan horse addition library command left file system privileged usergroup might accidentally use pirate leave program running  idle  terminal simulate login su command solution nt trust idle terminal especially dont fall obvious swindle  login incorrect   l found  think mistype sure login command particular generally executable login emulator must  fail login  dialin access dialin line potential hole solution keep phone number private possible set getty hang short time add  external security  password getty rewrite limit logins external line using etcsecuretty use new logging feature login user password user without password subject another user login su identity solution insure user password even pseudousers like    sync  case su c allows dangerous action necessary put   password field etcpasswd make impossible login su user deny access su command group secure newgrp command allows changing group identity manner similar su except group password user group list newgrp solution insure group correct user list andor group dummy   real password andor disable newgrp command putting real password group open anyone actually reduce security good password used bad password lead easy violation security solution nt use permutation username people real name easytoguess personal data use long password dictionary mix uppercase digit character nt reuse old password change password periodically educate system user also disable account n bad login attempt make easier pirate lock system administrator comment system v passwd improves situation use password timeout facility see passwd lead fast selection bad password leaf user unable change fast user still need two different password pirate easily find abandoned account hide password pirate advantage copy password file contains valid encrypted password solution make impossible copy uucp keep real password different file put fake one etcpasswd requires change many system library command probably attempted onsite standardized rsh restricted shell impossible completely right solution use deterrent account needed depend alone guarantee security chroot chroot command chroot system call normally executable superuser ordinary user could chroot subfilesystem could create small directory structure dummy etcpasswd make copy binsu binsh therein chroot su make copy sh setuid superuser later use solution restrict access chroot command make setuidsetgid program su unreadable unfortunately prevent linking crontab path usrlibcrontab must secure file plus part path file invokes including file plus file turn invoke file script program run cron superuser must replaceable trojan horse solution check crontab carefully occasion keep unreadable public use su c andor newgrp crontab running command eg exec su news c  exec notedemonday  minimize process run automatically root run cron unlikely comment shell script cronck exists help limited check crontab command command easy violate chmod superuser spooled shell script atrun demon run script owner solution possible protect usrspoolat unwritable setuid atrun command may sufficient nt run atrun crontab eg disable facility comment system v corrects mailer mailer program save file might let user modify etcpasswd appending especially run setuidsetgid also mailer bad habit prepending   line containing name process owner innocent bystander mail passing system thus revealing name least one user system also mailer use logname name sender solution program must modify nonowned file avoid running program setuidsetgid possible keep sensitive file protected nt reveal random usernames mailer program nt use logname crypt commandlibrary encryption used hard break thought see bell system technical journal volume number part solution leave cleartext around help break key found nt use key password simple doublecrypting preoring pattern nt help packing otherwise redistributing data uucp configuration file usrspooluucp publicly readable default uucp owns certain file demon uucp password well known user use su c mess demon command userfile file must properly constructed lsys file contains private information like phone number diallog contains phone number solution hide protect usrspooluucp necessary keep mail transaction secret avoid change uucp logins user uucp remote system name people knowing password ca nt dork uucpowned file keep uucp password secret insure command userfile protected including path conservative limit access except required insure lsys owned uucp generally readable default diallog protected action necessary btmp sulog file file exist login su respectively use log failed login attempt su attempt usernames logged btmp password occasion user might type password login prompt also sulog help pirate found system administrator solution sure usradmbtmp usradmsulog readablewritable superuser path secure longterm perhaps login su chmod file necessary note smart pirate never use su anyway data encrypted sensitive data life disc shared file people file system problem worst case make data public solution encrypt sensitive data keep private medium use quoted document unquoted shell   document see sh cause trouble example line  rm r xdir  appears x set script executed file system could injured solution quote document especially shell script input unless good reason    log start pm   received deathcertseicmuedu sparkyfsergsricom davy id aa fri feb   received localhost deathcertseicmuedu  id aa fri feb   messageid aa deathcertseicmuedu davy ergsricom subject list date fri feb  est dan farmer df certseicmuedu bug reference sheet comfirmations addition change df certseicmuedu last change made dec x bsd version problem            mail directly file run set gid program dump core set gid owner lock  compiled password  hasta la vista  plus z pre  ifs w preserve bug vi suspend mkdir ln file want dir file  lock  compiled password  hasta la vista  ln passwd file mail spool mail user  file truncate read file finger  string binrm f etcpasswd  foobar ln target plan finger user read file lpr file rm file ln anyfilename file  print file adb su change check memory shell su  root race condition get root via    ftp n quote user ftp ect get root privs lpd overwrite file ln anysuidfile get suid shell fchown chown file race condition expreserve get root via   passwd choke long line split pw file  root access  tahoe chfn  allows newlines meta char bufsize problem login ttya b cat ttyb z b exit login b pwuid got b pw overwrite get buffer  fingerd etc uudecode alias overwrite rootdaemon owned file binmail binsh get uidbin shell rwall bug adb running kernel shell get root sendmail mail nonroot owned file try twice rshd  spoof via nameservice rsh target l uid sunos version problem           login n root requires password  ftp  connect w acct user root l put tmpfoo tmpbar result owned root   chsh  similar chfn x anyone restore file file chfn  allows newlines meta char bufsize problem rcp uid  pcnfs ln anysuidfile get suid shell selection service remotely grab file  sendmail mail nonroot owned file try twice login ttya b cat ttyb z b exit login b pwuid got b pw  shared libs accept relative path running suid eg xterm rshd  spoof via nameservice rsh target l uid adb running kernel shell get root ftp n quote user ftp ect get root privs symlink plan target file finger user read overwrite get buffer  fingerd etc  rwall bug  yes lpd overwrite file window manager used read file rexd  get root access enabled  rcp buffer overflow  comsat overwrite file ptrace allows become root openlook telnet port executive x run p interp ultrix version problem            ln passwd file mail spool mail user  file get root host running nfs root account nontrusted host due bug mount daemon dynix  also  lock  compiled password  hasta la vista  user mount filesystem login run program root privs x nt clear password memory devmem world readable ln target plan finger user read file  limit file passwd  zero passwd file lpd overwrite file back   overflow risc register buffer get root mail chfn  allows newlines meta char bufsize problem ftp n quote user ftp ect get root privs change host name mount filesystem uudecode alias overwrite rootdaemon owned file  rshd  spoof via nameservice rsh target l uid system v version problem           set ifs environment  login  prompt svr expreserve problemrace condition pre svr write file race condition using mkdir ln sgi iris mips steller              stellix  rsh host l   command run root riscos  dynix stellix  login r hostname ruser luser term hpux version problem            chfn  allows newlines etc different bug  apollo version problem           x max break root using srbak problem setgiduid amdahl ut version problem            nfs mountd us hostname authentication easy spoof sco version problem           rlogin acct root etc trusted host wo password bell tech sys v           microport  ulimit passwd  zero passwd file yp           pre  user run yp server  ypbindypserv sunos  need machine  concurrent yppasswd session trash yp passwd map ypserv send map anyone guess domainame ultrix allows newlines meta char buffsize problem yppasswd leaf yp data file world writable ypbind take ypset anyone say yp db server sendmail            bsd mail directly file sun   mail file root owned try twice  sun lot others group incorrectly checked get group ultrix  dynix  c file  display file ultrix  hpux version   sm oq  readwrite file   binrm etcpasswd  bounce mail  irix  user read user mail wiz shell get root shell x           xr snoop keyboard bitmap xr set log execute command fixed  fix  uucp           sun  uucico show ph num login passwd remote machine tcpip           icmperror error handled correctly log user remotely misc           gnuemacs emacsclientserver allows access file yogi   subject summary bsd kernel change improved security use ucsc sysinitsysentc  added system call chfile insure user tty drop dtr lead user log requires change etcinit  kernexecc getxfile  restrict setuidroot file root device bother system administration greatly cut territory searched spurious setuidroot program  kernprotc setpgrp tested prevent user able kill another user background job  insure pgrp use somebody else  kernsigc core  keep core file private  kernxxxc added chfile code sysinodec rwip  turn suid sgid bit file written even super user strengthen security  sysprocessc procxmt ifdef ucsc  security patch denelcor   prevents user running setuidroot program debugger modifying code core image resuming execution modified code original privilege  ufsfioc access  make group gid zero privilege default login group super user file nt know group really belong  ufssyscallsc copen  security patch require special file inodes rootdev  link ifdef ucsc  security linking file user ca nt read  symlink ifdef ucsc  symbolic link thing user ca nt read either  chmod  enforce special restriction sticky bit setuid bit   warn super user inadvertently given somebody privileged file  chown  include super user protection afforded turning suidsgid bit  ufsfioc ifdef grpmast  allow group manager access non rootowned file   convenient instructional class account user uid  gid password file owner class privilege file class group owner  actual patch available request ucbvax ucscc haynes  starting project keep track unix security hole fix basically consists writing short monograph short called  paper  security hole find including example using break security including fix figure get others also trying put something found bug reported know thing usually found multitude people acting independently always curious thing came  essence im trying start reference file security hole fix like ask help getting project moving know interesting security hole would pas along fix would appreciated access  bsd system check hole version unix quite interested hole system v nt access pure system v version unix system v berkeley enhancement sure actually test hand might suggest hole  bsd send unix security hole know thanks one help give  peace matt bishop mab riacsarpa arpanet  decvax decwrl riacs mab one uucp path  ihnp ames riacs mab another uucp path  vsuitelst hole list first part usaf unix security paper vsuite project  general  allow usernames contain following character   shell metacharaters allows setuid root program popen spoofed never allow setuid root program send mail message user creates either berkeley mailer mailx user break root send line cp binsh tmpsh chmod tmpsh berkeley mail berkeley mailx allow shell escape executed line start column one stdout entering message text security hole unix related incorrect setting directory file permission race condition kernel allow setuid program exploited nonstandard setuid program examined many system compromised nfsrpc skilled rpc writer break security relatively easily mit project athena came kerberos address problem network usually insecure mount command executeable ordinary user setuid program mountable disk trusted system allow readonly mounting foriegn disk security hole setuid program normally honored allows person root access foriegn machine break another expreserve huge hole see following devfb frame buffer device least sun world readablewriteable best annoying someone run something strange worst insecure since someone take snapshot screen via screenload whatnot devst mt etc tape device generally world readablewriteable bad since others nuke tape read backup etc chfn chsh used create root account core system dump setgid core image domain name system sysadmin running soa domain somewhere create bug reverse address mapping table one host cause ip address domain name machine host hostsequiv file using usual version istrusted think thats routine name address lookup reveals name host one host trust sysadmin rlogin machine rsh whatnot fchown test bad group test ftruncate used change majorminor number device fingerd hard plan link reading unreadable file readable user fingerd setuid plan link running root fingerdtestsh buffer overrun file mod test test file loose setuid bit modified ftp ftpd static passwd struct overwrite  based bug userid reset properly logging enter comment  user root  last seen onder sunos  overwrite stack somehow hostsequiv default entry istrusted routine easy spoof bad soa remote site hacked reverse address map lock bsd version password  hasta la vista  builtin trapdoor found ultrix lostfound fsck lostfound mode else others might see private file lpd possible ovberwrite file root authority user level access locally remotely local root access lpr lpr r access testing problem lprm trust utmp passwd fgets use allows long entry mangled  entry also allows fred    fred  flintstone binsh fred    fred   flintstone binsh root entry password fix skip eol nt read whole entry enforce buffer limit text file nt use atoi since atoi binsh portmap allows net entity make binding may  security hole  lead denial service rcp nobody problem rexd existence rwall comsat running root utmp world writeable writes file well device utmp dev field rdist buffer overflow selectionsvc allowed remote access file sendmail debug option wizard mode turn command allows mail stolen decode mail alias anyone send mail decode write file onwed daemon connect sendmail daemon write file owned user overflow input buffer cause sendmail deamon lock overwrite file sendmail  tricked  delivering mail file root oq different q fixed newer version mqueue must mode uid program run sendmail bt cusrspoolmailuser old version allows see line file setuid bit handling setuidsetgid bit dropped file modified fix kernel change setuid script several problem setuid script worth writing test system might fixed hole anyone know one fix problem proactive fashion sh ifs hole used vi anything else su overwrite stack somehow tcpip sequence number prediction make host spoofing easier source routing make host spoofing easier rip allows one capture traffic easily various icmp attack possible suspect traceroute kernel allow one easily dump packet onto ethernet tftp allows one grab random file eg etcpasswd fix chroot allows put well get chroot fix nt run root use chroot put boot server utmp check see world writeable data ca nt trusted although program written though trust data comsat rwalld uucp check valid uucp account etcftpusers shell uucico passwd valid make sure listed ftpusers check see uucp account shell left folk cat x myhost myname uucp x uucprhosts rsh myhost l uucp sh hdb nostrangers shell escape hdb changing owner set uidgid file hdb meta escape x command line hdb break x line uudecode setuid version create setuid file ypbind accepts ypset anyone create ypserv data ypset  ypserv spoofing send lot bogus reply request root passwd entry something would generate request pretty sure possible nt tried aix password mean use root password aix  shadow password file etcsecuritypasswd world writeable fix chmod  login fix nuke logintool hack login adb chmod ultrix  login login p progname allows one run random program root fix chmod  xhost access access control disabled one connect x display possible create forge andor intercept keystroke eof 