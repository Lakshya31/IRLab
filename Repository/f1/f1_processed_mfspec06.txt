document dave oppenheim current version midi file specification sent participated development consensus seems submit midi manufacturer association version  apologize loss clarity might occurred conversion microsoft word document pure text file removed discussion recent change specification order keep file size reasonable  doug wyatt standard midi file  march introduction describes proposed standard midi file format midi file contain one midi stream time information event song sequence track structure tempo time signature information supported track name descriptive information may stored midi data format support multiple track multiple sequence user program support multiple track intends move file another one format allow happen spec defines bit binary data stream used file data stored binary file nibbleized bitized efficient midi transmission converted hex ascii translated symbolically printable text file spec address bit stream like make midi file  happen soon possible please respond soon comment proposal midi file transmission midi metaevent event comment question anything specification please direct comment dave oppenheim opcode system hamilton court menlo park california  sequence track chunk file block structure sequence file made chunk chunk character type bit length number byte chunk macintosh data passed either data fork file clipboard file type macintosh file format  midi  computer data simply content file structure allows future chunk type designed may easily ignored encountered program written chunk type introduced program expect alien chunk treat nt proposal defines two type chunk header chunk track chunk header chunk provides minimal amount information pertaining entire midi file track chunk contains sequential stream midi data may contain information midi channel concept multiple track multiple midi output pattern sequence song may implemented using several track chunk midi file always start header chunk followed one track chunk mthd length header data header data mtrk length track data track data mtrk length track data track data  track data format mtrk chunk type mtrk chunk type actual song data stored simply stream midi event nonmidi event preceded deltatime value number mtrk chunk represented form called variable length quantity number represented bit per byte significant bit first byte except last bit set last byte bit clear number thus represented exactly one byte example number represented variablelength quantity number hex representation hex f f c fff ff f c fffff ff ff f c fffffff ff ff ff f largest number allowed fffffff variable length representation must fit bit routine write variablelength number theoretically larger number possible x th beat fast tempo beat per minute four day long enough deltatime syntax mtrk chunk track data mtrk event mtrk event deltatime event deltatime stored variablelength quantity represents amount time following event first event track occurs beginning track two event occur simultaneously deltatime zero used deltatimes always present storing deltatimes requires least two byte value deltatimes nt zero deltatime fraction beat second recording track smpte time specified header chunk event midi event sysex event metaevent midi event midi channel message running status used status byte may omitted first byte first event file must specify status deltatime considered event integral part specification notice running status occurs across deltatimes metaevent specifies nonmidi information useful format sequencer syntax ff type length byte metaevents begin ff event type byte always le length data stored variablelength quantity data data length sysex event running status allowed chunk future metaevents may designed may known existing program program must properly ignore metaevents recognize indeed expect see new  program must never ignore length metaevent recognize nt surprised bigger expected must ignore everything past know however must add anything end metaevent sysex event used specify midi system exclusive message  escape  specify arbitrary byte transmitted unfortunately synthesizer manufacturer specify system exclusive message transmitted little packet packet part entire syntactical system exclusive message time transmitted important example byte sent cz patch dump fb  system exclusive mode  microtonal data transmitted able handle situation like two form sysex event provided f length byte transmitted f f length byte transmitted case length stored variablelength quantity equal number byte following including message type f f byte follow including f end intended transmitted first form f code used syntactically complete system exclusive message first packet series ñ message f transmitted second form used remainder packet within syntactic sysex message begin f course f considered part system exclusive message course midi running status allowed case length stored variablelength quantity may may start bit set new  syntactic system exclusive message must always end f even reallife device nt send one know reached end entire sysex message without looking ahead next event midi file principle repeated illustrated paragraph vast majority system exclusive message use f format instance transmitted message f f would stored midi file f f mentioned required include f end reader midi file know read entire message special situation single system exclusive message split part transmitted different time casio cz patch transfer fb  system exclusive mode  f form sysex event used packet except first none packet would end f except last one must end f also must transmittable midi event packet multipacket system exclusive message example suppose byte f sent followed tick delay followed byte followed tick delay followed byte f would midi file f tick deltatime f tick deltatime f f f event may also used  escape  transmit byte whatsoever including realtime byte song pointer midi time code permitted normally specification effort made interpret byte used way since system exclusive message transmitted necessary appropriate end f event f case header chunk header chunk beginning file specifies basic information data file data section contains three bit word stored high byte first course syntax complete chunk chunk type length format ntrks division described chunk type four ascii character mthd length bit representation number high byte first first word format specifies overall organization file three value format specified file contains single multichannel track file contains one simultaneous track midi output sequence file contains one sequentially independent singletrack pattern next word ntrks number track chunk file third word division division quarternote represented deltatimes file division negative represents division second represented deltatimes file track represent event occurring actual time instead metrical time represented following way upper byte one four value     corresponding four standard smpte midi time code format represents number frame per second second byte stored positive resolution within frame typical value may midi time code resolution bit resolution system allows exact specification timecodebased track also allows millisecondbased track specifying framessec resolution unit per frame format one multichannel track interchangeable representation data one application midi file simple singletrack player program need make synthesizer make sound primarily concerned something else mixer sound effect box desirable able produce format even program trackbased order work simple program hand perhaps someone write format conversion format format might easy use setting would save trouble putting program program support several simultaneous track able save read data format vertically onedimensional form collection track program support several independent pattern able save read data format horizontally onedimensional form providing minimum capability ensure maximum interchangeability midi file express tempo time signature chosen transferring tempo map one device another format file tempo scattered track tempo map reader ignore intervening event format file tempo map must starting  stored first track polite tempo map reader offer user ability make format file tempo unless use format midi file specify tempo time signature nt time signature assumed  tempo beat per minute format metaevents occur least beginning single multichannel track format meta event contained first track format temporally independent pattern contain least initial time signature tempo information may decide define format id support structure program reading unfamiliar format id return error user rather trying read metaevents metaevents defined herein required every program support every metaevent metaevents initially defined include ff sss sequence number optional event must occur beginning track nonzero deltatimes transmittable midi event specifies number sequence number track corresponds sequence number new cue message discussed summer mma meeting format midi file used identify  pattern   song  sequence using cue message refer pattern id number omitted sequence location order file used default format midi file contain one sequence number contained first track transfer several multitrack sequence required must done group format file different sequence number ff len text text event amount text describing anything good idea put text event right beginning track name track description intended orchestration information user want put text event may also occur time track used lyric description cue point text event printable ascii character maximum interchange however character code using highorder bit may used interchange file different program computer support extended character set program computer support nonascii character ignore character new  meta event type f reserved various type text event meet specification text event used different purpose ff len text copyright notice contains copyright notice printable ascii text notice contain character c year copyright owner copyright several piece music midi file copyright notice placed together event beginning file event first event first track chunk time ff len text sequencetrack name format track first track format file name sequence otherwise name track ff len text instrument name description type instrumentation used track may used midi prefix metaevent specify midi channel description applies channel may specified text event ff len text lyric lyric sung generally syllable separate lyric event begin event time ff len text marker normally format track first track format file name point sequence rehearsal letter section name  first verse  etc ff len text cue point description something happening film video screen stage point musical score  car crash house   curtain open   slap face  etc ff f end track event optional included exact ending point may specified track exact length necessary track looped concatenated ff tttttt set tempo microsecond per midi quarternote event indicates tempo change another way putting  microsecond per quarternote   th microsecond per midi clock  representing tempo time per beat instead beat per time allows absolutely exact longterm synchronization timebased sync protocol smpte time code midi time code amount accuracy provided tempo resolution allows fourminute piece beat per minute accurate within usec end piece ideally event occur midi clock would located ñ convention intended guarantee least increase likelihood compatibility synchronization device time signaturetempo map stored format may easily transferred another device ff hr mn se fr ff smpte offset new  smpte format specification event present designates smpte time track chunk supposed start present beginning track nonzero deltatimes transmittable midi event hour must encoded smpte format midi time code format file smpte offset must stored tempo map meaning track ff field contains fractional frame th frame even smptebased track specify different frame subdivision deltatimes ff nn dd cc bb time signature time signature expressed four number nn dd represent numerator denominator time signature would notated denominator negative power two represents quarternote represents eighthnote etc cc parameter express number midi clock metronome click bb parameter express number notated ndnotes midi quarter note midi clock added already multiple program allow user specify midi think quarternote clock notated related term something else therefore complete event  time metronome click every three eighthnotes clock per quarternote bar would hex ff  time rd power midi clock per dottedquarter hex eight notated ndnotes per midi quarter note ff sf mi key signature sf  flat sf  flat sf key c sf sharp sf sharp mi major key mi minor key ff f len data sequencerspecific metaevent special requirement particular sequencer may use event type first byte byte data manufacturer id however interchange format growth spec proper preferred use event type type event may used sequencer elect use file format sequencer established featurespecific format probably stick standard feature using format program fragment example midi file routine read write variablelength number midi file routine c use getc putc read write single bit character fromto file infile outfile writevarlen value register long value register long buffer buffer value xf value buffer buffer  x buffer  value xf true putc buffer outfile buffer x buffer else break doubleword readvarlen register doubleword value register byte c value getc infile x value xf value value c getc infile xf c x return value example midi file following excerpt shown first format file shown information intermingled format file shown data separated four track one tempo time signature three note resolution  tick  per quarter note used time signature  tempo though implied explicitly stated  content midi stream represented example broken delta time decimal event code hex byte decimal comment ff byte  time midi clocksclick nd note midi clock ff byte  µsec per quarternote c ch program change c ch program change c ch program change c ch program change ch note c forte ch note c forte ch note g mezzoforte ch note e piano ch note c standard ch note c standard ch note g standard ch note e standard ff f track end entire format midi file content hex follow first header chunk mthd chunk length format one track per quarternote track chunk header followed event notice running status used place b mtrk b chunk length deltatime event comment ff time signature ff tempo c c e c c running status c twobyte deltatime c running status c ff f end track format representation file slightly different header chunk mthd chunk length format four track per quarternote first track chunk time signaturetempo track header followed event b mtrk chunk length deltatime event comment ff time signature ff tempo ff f end track track chunk first music track midi convention note onoff running status used example b mtrk chunk length deltatime event comment c c c running status note vel ff f end track track chunk second music track b mtrk f chunk length deltatime event comment c e running status ff f end track track chunk third music track b mtrk chunk length deltatime event comment c c running status twobyte deltatime running status c running status ff f end track midi transmission midi file since inconvenient exchange disk different computer since many computer use format midi interface anyway midi seems like perfect way send file one computer another going trouble make way sending midi file would nice could send file like sampled sound file text file etc goal transmission protocol midi file reasonably efficient support fast transmission computer capable slower transmission le powerful one impossible convert midi file arbitrary internal representation fly transmitted long difficult desirable use generic method file type could accommodated make protocol efficient midi transmission file take group seven bit byte transmit eight bit midi data byte certainly spirit rest format keep small hard accommodate wide range transmission speed file transmitted packet acknowledge  allows data stored disk received sender receive response reader certain amount time assume openloop situation continue last edition midi file contained specialized protocol sending midi file meet deadline unfortunately nt time right propose new generalized protocol done within next couple month would welcome proposal anyone else would direct attention proposal ralph muha kurzweil available recent mma bulletin also directly  