 c  language emulation automag paintball gun version  introduction program calculates behavior automag paintball gun using simple model gun please see automag manual explanation terminology program run emulate  second wait gun charge psi trigger pulled ball ejected fps order set scenario timing loop main trigger subroutine updatet must modified user explanation program point time gun considered completely described specifying set pressure volume surface area position velocity certain key element gun computer program subroutine tstep take set variable describing state gun along time time step dt calculates new value variable time tdt  marching algorithm  accurate long time step dt small enough dt small take long time program calculate reasonable amount time good value dt seems millisecond check whether small enough time step used cut time step factor see result time step increased factor result larger time step used two type subroutine used tstep flow rate subroutine starting  q  moving part update subroutine starting  u   flow rate subroutine volume chamber gun   signifies source eg co bottle  r  regulator chamber   air chamber  b  barrel thus example pvpr regulator chamber pressure pvvr regulator chamber volume qra subroutine calculates rate flow regulator chamber air chamber regulator valve connects source regulator chamber onoff valve connects regulator chamber air chamber bolttopower tube oring  valve  connects air chamber barrel flow rate subroutine calculate rate flow gas one chamber according crude equation q pv dt pv dt cl zx pp p v pressure volume upstream chamber p v pressure volume downstream chamber cl leakage flow rate order bad orings may modelled zx normal flow rate x measure open valve z proportionality constant x becomes negative assumed flow stopped pressure time tdt calculated assuming constant volume v p tdt p qinqout dtv qin rate chamber qout rate chamber  moving part update subroutine moving part gun moved pressure differential applied various surface spring friction finger moving trigger generally force f surface area due pressure difference given f pp p p pressure either side surface force element due spring f k xx x length spring x relaxed length k spring constant force due friction taken f rv  v velocity part r proportionality constant massive part moved position x velocity v part must known order predict motion acceleration part afm f force part mass part position velocity part time tdt calculated x tdt x v adt dt v tdt v adt b  source pressure pressure source pvps assumed derive equilibrium vapor pressure liquid carbon dioxide temperature pvt vapor pressure data found crc handbook chemistry physic th edition copyright data given temperature degree kelvin logarithm pressure function temperature fitted third order polynomial source pressure calculated using four coefficient polynomial  regulator assumed gas source pressure pvps applied input regulator diagrammed schematically         onoff valve               e   b     c              v source regulator nut b regulator piston c regulator valve regulator seal e regulator spring pack   represents spring assumed left end regulator valve always contact regulator piston actually regulator valve spring contact right end regulator valve keep pushed regulator piston gas enters source flow past regulator valve part regulator chamber holding regulator piston pressure force piston left regulator valve move process continues regulator valve head come contact regulator seal stop flow equation used calculate rate flow gas past regulator valve qsr zrcl zrzzrx pvpspvpr zrx distance bottom regulator valve head top regulator seal pvps source pressure pvpr regulator chamber pressure zrz flow ratelength regulator valve zrcl leakage rate regulator valve position regulator valve determined position regulator piston regulator piston pushed left regulator spring pushed right higher pressure regulator chamber regulator piston move far right run stop force regulator spring increased moving regulator nut right compressing spring let say zrx value zrx regulator piston stop zrtzrh distance regulator nut compress spring beyond relaxed length regulator piston stop zrt number turn regulator nut clockwise zrh number turn per inch regulator nut position regulator piston found assuming spring force pressure force always equal zrk l l zr pvprpvpx l relaxed length regulator spring l compressed length spring compressed compressed left zrtzrh inch regulator nut zrxzrx pressure force mean l l zrtzrh zrx zrx two equation solved zrx zrx zrx zrtzrh pvprpvpx zrszrk  equation used inupdater  onoff valve schematic diagram onoff valve given       regulator     air chamber           b      sear equation used calculate flow onoff valve qra zocl zozzox pvprpvpa zox distance top regulator pin onoff oring pvpr regulator pressure pvpa air chamber pressure zrz flow ratelength onoff valve zrcl leakage rate onoff valve position onoff pin controlled sear turn controlled trigger assumed bottom onoff pin connected sear actually regulator pressure push sear trigger released sear tilted zero degree trigger pulled onoff valve position zox decrease according zox ztxssin zobzobo ztxs length sear arm connecting pivot point  b  diagram point contact onoff pin   diagram zobo angle onoff pin contact teflon onoff oring equation implemented updateo except assumed angle zobzobo small enough sin zobzobo replaced zobzobo  power tube schematic diagram power tube given                            air chamber bolt barrel                                    sear equation used calculate flow power tube valve qab zpcl zpzzpx pvpapvpb zpx distance bolt right power tube oring   diagram pvpa air chamber pressure pvpb barrel pressure zrz flow ratelength past power tube oring zrcl leakage rate past power tube oring position bolt controlled pressure difference air chamber barrel power tube spring   diagram sear bolt move zpxc inch left power tube oring latched sear long sear angle ztbl greater bolt latch point stopped moving left bolt move right zpxm inch strike stop main body stopped moving right anywhere two point equation give force bolt except bolt contact power tube oring assumed additional frictional force bold according equation  equation b determine motion implemented subroutine updatep  ball barrel ball pushed barrel difference pressure barrel atmosphere complication barrel volume volume barrel bolt ball changing ball move barrel barrel volume vb given vb pizbdzbd zbx vb calculated zbx updated vb tdt calculated zbx updated rate equation p tdt vb tdt pvpbvb qabqbx dt solved pvpb tdt equation b used update position ball ball move beyond end barrel barrel pressure atmospheric tried worrying whether ball contact foamie pushed bolt whether pushed barrel pressure seemed like always pushed barrel pressure nt bother including model even though need included also nt hard model vented barrel determine much gas efficient undrilled barrel  estimation constant geometric value obtained direct measurement gun obtained automag manual  power tube spring constant spring constant power tube spring estimated placing pound weight spring noting deflection  regulator spring pack spring constant manual say gun nominally charged psi knowing much regulator nut compress spring pack condition assumed nt compress mean spring constant spring pack found solving equation  zrx zrt zrk zr pvx zrx  value zrk probably improved find much regulator spring pack compressed gun charged psi  air chamber volume manual say oz tank co provide good shot gun probably usable ounce tank shot per ounce co reasonable estimate gas consumption per shot assuming air chamber fill pressure psi temperature degree f solve ideal gas equation pvva pvpapvva nrpvt n  oz e mole r jmoledeg k give air chamber volume   valve flow rateslength manual say gun charge psi third second flow rate constant zrz found hitormiss air chamber filled percent steady state value ie psi  second value flow ratelength used regulator valve onoff valve  power tube flow rateslength air chamber filled psi assumed ball ejected inch barrel fps power tube flow ratelength adjusted case  power tube friction coefficient friction coefficient set zero  lawn sprinkler  scenario bolt motion dominated resonant frequency bolt spring coefficient much greater  evidence natural frequency lost chose value  interesting bolt motion equal component cycle per second thinking done get value constant correct scenario print statement main program output number variable different scenario given following modification program along description expected printed output  simple shot run program regulator chamber charge  psi air chamber charge  psi  second trigger go ball ejected  fps  fast stroke regulator air chamber precharged psi trigger subroutine turn trigger begin first ball come  fps trigger subroutine wait air chamber emptied turn trigger  sec  second later  sec second ball come  fps becuase air chamber could fully charge  second ztb ztbb  trigger pulled  pvpr   regulator chamber charged  pvpa   regulator chamber charged  dt  n   insert updatet   static double delt double cycle cycle   time trigger sec  ztb ztbb zbx zbl pvpa pvpx ztb   trigger  zpx   bolt latched  zpv  zbx   ball loaded  zbv   ball motionless  delt  reset timer  else tdelt cycle ztb ztbb  trigger  ret return                   lawn sprinkler leakage onoff valve put ball loaded done putting position ball zbx outside barrel ie zbx zbl trigger always regulator air chamber pressure set roughly steady state value need nt zbx zbl  ball  ztb ztbb  trigger  zpx  bolt zero  zoc   onoff leak  pvpr  steady state  pvpa   steady state  n dt    insert updatet   ztbztbb return                   cold gun low temperature lower vapor pressure co result slow charging gun possibly incomplete charging set temperature pvt degree f run short stroke scenario second ball come  fps even le due lower source gas pressure 