stoll dockmasterarpa subject virus arpanet milnet date thu nov  est arpanet  sendmail  virus attack november hi gang  wednesday november tired dont believe everything follows  apparently massive attack unix system going right spoken system manager several computer east west coast suspect may system wide problem symptom hundred thousand job start running unix system bringing response zero system attacked unix system bsd unix variant eg sun sendmail compiled debug problem see virus spreading quickly milnet within past hour evidence hit site across country arpanet milnet site suspect well site hit  major  site gateway method apparently someone written program us hole smtp sendmail utility utility send message another program step distant milnet host message sent sendmail fire sed sed editor possible certain version sendmail see line c program sent sed sendmail distant computer sends command compile c program several object file copied unix computer file one targeted sun one targeted sun one targeted vax ultrix probably vms c program accepts address milnet site apparently program scan milnetarpanet address repeat process bug sendmail unix  bsd version sendmail compiled debug option hole unix system bsd  sun apparently bug exists system manager recompiled sendmail enabled debugging bad news cliff stoll dockmasterarpa                                    gene spafford spaf purdueedu subject virus date thu nov  est vaxen sun infected virus virus fork repeated copy try spread load average infected machine skyrocketed fact got point machine ran swap space kernel table entry preventing login even see going virus seems consist two part managed grab source code one part main component virus clean leave evidence way work follows virus running infected machine open tcp connection victim machine sendmail invokes debug mode get shell shell creates file tmp named lc get replaced current process id copy code  listener   helper  program dozen line long fairly generic code shell compiles helper using  cc  command local system helper invoked argument pointing back infecting virus giving hostidsocketpasswords argument helper connects  server  copy number file presumably tmp file copied exec shell standard input coming infecting virus program end socket speculate happens since ca nt find source part lying around machine newly exec shell attempt compile file copied target machine sure else virus anything  may also attempting add bogus passwd file entry something file system helper program array filename  helper  copy room spare two version copied  version vax bsd version sunos appropriate one compiled new virus dispatched virus open virus source file unlinks file ca nt found since open however still access content next virus step host file sun us yp step distributed host file trying connect machine sendmail connection succeeds fork child process infect parent continues attempt infection machine child request initializes new socket build invokes listener new socket number hostid argument heavy load see result multiple virus coming multiple site since local host file tend entry local host virus tends infect local machine multiple time  sens lucky since help prevent spread virus local machine slow virus also  clean  reboot infected machine crash tmp directory normally cleaned reboot incriminating file already deleted virus clever nasty definitely antisocial  spaf                                      bishop beardartmouthedu matt bishop subject virus date thu nov  est  program introduced bug sendmail site sendmail compiled installed debugging option turned near figure nt access sendmail source giving specific option  debug  command sendmail lot controlling exactly get information cause execute command sendmail run setuid root guess privilege command executed right apparently attacker connected sendmail ie telnet victimmachine issued appropriate debug command small c program compiled big deal program took argument host number copied two program  one ending qvaxo ending suno  tried load execute case load execution succeeded worm two thing least spawn lot shell nothing clog process table burn cpu cycle look two place  password file internet service file  site could connect hearsay nt doubt minute used individual rhost file found using password file remote host could locate chance connecting may done one machine changed superuser password factor sure worm last part still sketchy relevant suno file take apart see supposed appears serious damage wasted cpu cycle system administrator time two obvious point whoever picked sun vaxen one site lot iris two crays ie nasa ames got bit sun vaxen attempt get machine nt work show sorry state software security unix world people never put program debugging hook especially hook made execute arbitrary command sendmail used distributed one interesting point initially thought application  principle least privilege  would prevented penetration attacker used worldwriteable directory squirrel relevant program  effect  everything could done user system except superuser password change course  worm fact think way prevent attack would turn deug option sendmail penetration would fail go show computer secure like nt believe ever beastie simply way prevent virus case worm getting system know somewhat sketchy flabby fuzzy know far keep posted development  matt                                     bostic okeeffeberkeleyedu keith bostic subject virus read immediately date nov  gmt subject fix virus index usrlibsendmailsrcsrvrsmtpc bsd description virus running around salient fact bug sendmail used introduce virus lot internet unix system observed damage host system however incredibly virulent attempting introduce every system find appears use rsh broken password sendmail introduce target system affect vaxen sun far know three change believe immunize system attached thanks experimental computing facility center disease control assistance pretty late certainly deserved thanks somewhere fix first either recompile patch sendmail disallow debug option source recompile sendmail first applying following patch module svrsmtpc  tmpd thu nov   srvrsmtpc thu nov       onex  cmdonex ifdef debug  showq  cmddbgqshow  debug  cmddbgdebug endif debug ifdef wiz  kill  cmddbgkill endif wiz      onex  cmdonex ifdef debug  showq  cmddbgqshow endif debug ifdef notdef  debug  cmddbgdebug endif notdef ifdef wiz  kill  cmddbgkill endif wiz reinstall sendmail refreeze configuration file using command  usrlibsendmail bz  kill running sendmail using p command kill command restart sendmail find sendmail execed system use grep find sendmail start line either file etcrc etcrclocal nt source apply following patch sendmail binary save copy first case mess mildly tricky  note version string going use find offset string  debug  binary print offset octal decimal run following shell line decide version string work binecho abcd usrucbstrings note make sure eight control g preserved line command result something like abcd string command print location decimal else octal patch script sendmail note offset may vary script assumes string command print offset decimal script started thu nov  okeeffe tmp string usrlibsendmail egrep debug debug okeeffe tmp adb w usrlibsendmail xffffffff radix base ten debug w okeeffe tmp script done thu nov  string command print offset octal change line     fixed sendmail move bincc binld something else virus us cc ld command rebuild run system finally kill process system nt belong suspicious one  sh   xnnnnnnn  n random digit command name p output line one thing find file tmp usrtmp name like  xnnnnnn lc   xnnnnnn suno   xnnnnnnn vaxo  n random digit infected                                     news cspurdueedu news knower subject virus date nov  gmt patch keith bostic last message sufficient halt spread virus discovered looking binary virus also attempt spread via  rsh  command machine look lot file find possible vector spread bunch machine hostsequiv set rhosts file shut time fixed sendmail prevent infestation nt clear version memory wo nt protect machine virus run name  sh  overwrites argv  p ax  show process named  sh  without controlling tty problem due use uids rsh nt make conclusion uid one normal user also check mailq mailq command see entry pipe sed sh delete queue restart machine noninternet site need worry virus aware mail news may flowing everywhere time  many site disconnecting internet completely virus contained                                    gene spafford spaf purdueedu subject updated worm report date fri nov  est updated description worm work note technically worm virus since attach code know vaxen sun infected worm worm fork repeated copy try spread load average infected machine skyrocketed fact got point machine ran swap space kernel table entry preventing login even see going worm seems consist two part way work follows virus running infected machine open tcp connection victim machine sendmail invokes debug mode submits version mail message us rsh create remote machine account requiring password due hostsequiv rhosts entry get via bug fingerd us telnet later using sendmail route something like devnull  sed e  sh exit  cd usrtmp cat xc eof text program deleted eof cc x xc x  rm f x xc program simple  listener   helper  program hundred line fairly simple code see helper invoked argument pointing back infecting worm giving hostidsocketchecksum argument helper connects  server  copy number file presumably tmp file copied exec shell standard input coming infecting worm program end socket speculate happens since ca nt find source part lying around machine newly exec shell attempt compile file copied target machine command file us follows pathbin usrbin usrucb rm f sh f sh px else psh cc p binecho p p creates dispatch new worm worm open worm source file unlinks file ca nt found since open however still access content next worm step host file sun us yp step distributed host file trying connect machine sendmail connection succeeds fork child process infect parent continues attempt infection machine child request initializes new socket build invokes listener new socket number hostid argument note worm run stage first collect info etchosts file hostsequiv file file containing host name host ip address even run netstat find network machine attached us information attempt penetrate sendmail machine also know penetrate  fingerd  vaxen sun attempt result core dump privately tell individual fix bug fingerd change run  root  first stage appears sleep start collecting user name begin probing  rsh  also try attack password trying set builtin word content usrdict word snarfed system file succeeds breaking local password fork child use telnet break account copy write one seems know supposed eventually perhaps break everywhere know nt break account system enters mode try break root password via brute force searching suspect succeeds nasty thing note program corrupts argument vector appears  p ax   sh  login shell nt trust running program nt copy around source file except helper  copy around precompiled binary linked local machine run worm appears carrying binary based sun vax xx machine pyramid sun sequents definitely immune note infected awesome engine contagion string binary encrypted random  string  invocation binary keith bostic informs xor x reveal interesting thing although mask used first observation virus heard pm wednesday night pittsburgh nt hit purdue morning lucky site like cmu princeton hit around last night acknowledgement information obtained brian kantor ucsd keith bostic ucb thomas narten purdue dan trinkle purdue kevin braunsdorf purdue miek rowan purdue thanks guy                                      gene spafford spaf purdueedu subject worm  condom  date thu nov  est  kevin braunsdorf rich kulawiec purduecc come  condom  protect machine current worm sure work seems completely effective cant harm root mkdir usrtmpsh chmod usrtmpsh edit rclocal file recreate directory case reboot stop current infection prevent new one taking hold  prevents worm creating replica   spaf                                     gene spafford spaf purdueedu subject cure date thu nov  est flash kevin  adb friend  braunsdorf burst office cure discovered disassembled worm binary external variable library named  pleasequit  nonzero worm die immediately exiting thus kill new worm include patch library defines symbol following shell file source code modify c library define symbol wo nt kill currently linked running version prevent reinfection shar archive give following input binsh packed thu nov  est spaf uthercspurdueedu archive contains foosh fooc echo x foosh sed sx foosh endoffoosh xcc c fooc fooo xcp liblibca liblibcaold xar q liblibca fooo xranlib liblibca endoffoosh echo x fooc sed sx fooc endoffooc xextern int pleasequit  endoffooc exit                                     geoff fernwoodmpkcaus tty geoff goodfellow subject computer network disrupted virus date thu nov  pst computer network disrupted virus john markoff c ny time news service intrusion raise new question vulnerability nation computer nationwide department defense data network disrupted since wednesday night rapidly spreading  virus  software program apparently introduced computer science student malicious experiment program reproduced computer network making hundred copy machine reached effectively clogging system linking thousand military corporate university computer around country preventing additional work virus thought destroyed file late thursday afternoon computer security expert calling virus largest assault ever nation computer  big issue relatively benign software program virtually bring computing community knee keep time  said chuck cole deputy computer security manager lawerence livermore laboratory livermore calif one site affected intrusion  cost going staggering  clifford stoll computer security expert harvard university added  one system manager tearing hair causing enormous headache  affected computer carry routine communication among military official researcher corporation sensitive military data involved nation sensitive secret information control nuclear weapon thought touched virus computer virus named parallel computer world behavior biological virus virus program set instruction computer deliberately planted floppy disk meant used computer introduced computer communicating telephone line data network computer program copy computer master software operating system usually without calling attention program passed additional computer depending upon intent software creator program might cause provocative otherwise harmless message appear computer screen could systematically destroy data computer memory virus program apparently result experiment computer science graduate student trying sneak thought harmless virus arpanet computer network used university military contractor pentagon software program would remain undetected man said associate student said telephone call new york time experiment went awry small programming mistake caused virus multiply around military network hundred time faster planned caller refused identify programmer said student realized error shortly letting program loose terrified consequence spokesman pentagon defense communication agency set emergency center deal problem said caller story  plausible explanation event  virus spread wednesday night computer expert began huge struggle eradicate invader spokesman defense communication agency washington acknowledged attack saying  virus identified several host computer attached arpanet unclassified portion defense data network known milnet  said correction security flaw exploited virus developed arpanet data communication network established designed permit computer researcher share electronic message program data project information budget projection research result network split second network called milnet reserved highersecurity military communication milnet thought handle classified military information including data related control nuclear weapon arpanet milnet network connected hundred civilian network link computer around globe report virus hundred location coast including east coast computer massachusetts institute technology harvard university naval research laboratory maryland university maryland west coast nasa ames research center mountain view calif lawrence livermore laboratory stanford university sri international menlo park calif university california berkeley san diego campus naval ocean system command san diego spokesman naval ocean system command said computer system attacked wednesday evening virus disabled many system overloading said computer program facility still working problem hour original incident unidentified caller said arpanet virus intended simply  live  secretly arpanet network slowly copying computer computer however designer completely understand network worked quickly copied thousand time machine machine computer expert disassembled program said written remarkable skill exploited three security flaw arpanet network actually unix virus design included program designed steal password masquerade legitimate user copy remote machine computer security expert said episode illustrated vulnerability computer system incident like could expected happen repeatedly awareness computer security risk heightened  accident waiting happen deserved  said geoffrey goodfellow  president anterior technology inc expert computer communication  needed something like bring u sens paying much attention protecting  peter neumann computer security expert sri international inc menlo park international said  thus far disaster known relatively minor potential rather extraordinary destruction rather substantial  case know damage immediately evident contemplate effect hidden program could attack going might never know  following geoff full quote  exploitation  john partially integrated geoff earlier offthecuff comment  accident   exploitation wanting happen deserved needed something like bring u sens paying much attention protecting blame rest r community whole look many manufacturer  took original computersciencedepartment developed code willynilly put wrapper corporate logo resold customer real travesty build system ok great rarely build ask might abused broken circumvented  try break 