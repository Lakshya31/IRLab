netinfoblackerdoc blacker interface control document march march table content section subject page introduction  hostredside interface   physical level   link level   packet level   internet protocol feature   internet control message protocol feature  networkblackside interface   physical level   link level   packet level   internet protocol feature   internet control message protocol feature  initial ddn sensitivity label b reference b c blacker generated diagnostic code c march introduction  purpose document define interface blacker front end bfe document define service used network black side bfe interface defense data network ddn define service offered hostgateway red side host network plaintext ciphertext redside blackside                host  bfe  ddn gateway psn                 bfe act data communication equipment dce x network attached host bfe offer host x interface interface modified version interface presented ddn x host interface specification additional security functionality bfe additional requirement host interface level x layer additional requirement well specific detail x interface defined section document  following terminology used document unit information link x level level referred  frame  unit network x level level referred  packet  unit internet protocol ip level referred  datagrams  information contained datagram passed actual destination computer referred message appropriate modifier eg mail message byte unit data containing eight bit  blacker system ddn us x interface local interface mean type service offered provide endtoend service x bfe offer version ddn x standard service defined ddn x host interface specification dated dec restriction modification defined document interface also conforms fips pub july ccitt recommendation x well ddn host interface specification bfe provide support arpanet host interface protocol ahip also known bolt beranek newman inc bbn interface page  march  value field defined document unless otherwise designated decimal value leftmost bit byte field high order bit byte value  bfe parameter loaded via blacker initialization carrier bic include site identification access control center acc key distribution center kdc identification security level protocol parameter audit control value bic inserted read bfe first powered needed bfe reset zeroized completely lost power page  march redside host interface  section describes host interface blacker front end interface based upon standard defined ddn x interface requires internet protocol ip used next layer x host already implement current set ddn x protocol including ip use r balanced interface change minor  physical level bfe conform following three specification  defense data network x host interface specification  dca december eia standard r november military standard  march bfe support signal listed table b ddn x specification optional signal supported signal identified ccitt number host side r term bfe support category circuit balanced mode bfe also support type send receive mandatory circuit synchronous primary channel operation see fig  specification r  position connector glenair inc equal backshell used host interface bfe present dce interface host bfe operate speed  kilobit per second full duplex synchronous operation support ed data timing originate network dce blacker data terminal equipment dte blacker dce host note signal name used refer r name used following table rt signal supply data strobe rd st supply data request sd tt supply data acknowledgedata strobe sd dte must use incoming st signal generate data strobe signal tt interface signal electrical characteristic defined milstd single deviation specification open circuit balanced voltage driver output volt  volt instead volt  volt interface signal page  march function direction pin assignment defined r listing signal supported bfe redside pin r abbreviation dce shield connection si  spare sd balanced receiver st balanced generator rd balanced generator r balanced receiver rt balanced generator c balanced generator unbalanced receiver dm balanced generator tr balanced receiver rr balanced generator rl ib ic  sfsr ib tt balanced receiver tm unbalanced generator sg circuit ground rc dce circuit ground spare sd see pin st see pin rd see pin r see pin rt see pin c see pin ib dm see pin tr see pin rr see pin s ib sq  n ib tt see pin sb  sc dte circuit ground abbreviation r signal name ib pin open internal bias minus five volt optional ib pin open internal bias five volt optional page  march  link level bfe conform following link level specification  defense data network x host interface specification  dca december  interface data terminal equipment dte data circuit termination equipment dce terminal operating packet mode public data network  recommendation x ccitt  wd x packet network interface lapb  western digital corp sept preliminary april expected final publication level bfe use ddn x high level data link control link access procedure balanced hdlclapb interface protocol hostred side bfe dce hdlclapb interface bfe implemented using western digital wd packet network interface chip chip handle bit oriented full duplex serial data communication level level interface side computer interface side us direct memory access  transparent mode  wd chip described specification three used  packet level  bfe conform following packet level specification restriction extension described note page paragraph reference refer ddn specification number one paragraph reference begin letter  defense data network x host interface specification  dca december  interface data terminal equipment dte data circuit terminating equipment dce terminal operating packet mode public data network  recommendation x ccitt page  march  interface data terminal equipment dte data circuit terminating equipment dce operation packetswitched data communication network  fedstd fips pub july  standard service restriction ddn  standard service  x offered host interface provision  basic service  made call request host indicating  basic service  rejected pg  physical address restriction physical addressing supported bfe port assigned physical address defense communication agency address conform format defined following constraint address binary coded decimal bcd digit subaddresses supported f flag set zero request logical addressing facility result clear indication appropriate diagnostic code sent host early serial number bfes may return invalid called address invalid calling address diagnostic code pg  standard service restriction type service facility call request ddn  standard service  must always selected failure specify ddn  standard service  result clear indication packet diagnostic code sent host pg  call user data restriction protocol identifi cation field call request packet defined dte must indicate use dod internet protocol ip value defined ip binary cc hex must first byte present call user data field call request packet call user data field exactly one byte long result clear indication diagnostic either packet short packet long selection different value result clear indication packet diagnostic code sent host pg  packet size supported maximum packet size octet supported bfe maximum packet size octet required host accredited operate multiple security level maximum packet size octet strongly recommended host order allow ip datagram fit within single packet ip datagram size limitation discussed section  document pg  packet size limitation maximum permissible number data bit complete packet sequence must page  march byte bit attempt send byte result clear indication appropriate diagnostic code sent host pg  q bit restriction dbit qbit significance bfe passed destination set zero host pg  logical addressing support logical addressing request logical addressing facility receive clear indication packet appropriate diagnostic code sent host early serial number bfes may return invalid called address invalid calling address diagnostic code pg  derivation x address blacker pg device directly connected blacker front end ip address bit quantity consists two part first part defining network second network specific ddn red virtual network ddnrvn class network network identifier field eight bit wide network specific portion bit wide network number ddnrvn bit network specific part defined follows first bit zero next three bit port number bfe following ten bit domain number bfe last ten bit bfes number within domain shown graphically ip address  network port domain id bfe id  port field specifies routing bfe may take value zero seven currently defined value computer attached host port internal access control module internal internet control message protocol icmp server domain id bfe id field may take value inclusive x level ddnrvn x network supporting version ddn  standard service  described section device directly connected ddnrvn x address consists bcd digit form zzzz f ddddddd see subaddress feature defined never used ddnrvn zzzz value decided administration initially set f zero indicate physical addressing ddddddd directly mapped network specific portion ip address page  march first digit port id next three digit domain id last three digit intradomain bfe id mapping value conversion binary representation bcd representation shown graphically ip bbbbbbbbbbbbbbbbbbbbbbbb bit    x         x ddd ddd bcd digit example host host number domain wish talk internal icmp echo port would address message network domain host port graphic form ip address        x address port would  interrupt restriction interrupt interrupt confirmation packet supported  datagram restriction datagram service defined reference two supported  permanent virtual circuit restriction support permanent virtual circuit call need established via call request packet  x facility following facility described reference two supported bfe ccitt paragraph nonstandard default window size  nonstandard default packet size  flow control parameter negotiation  page  march following facility described reference two supported bfe ccitt paragraph extended packet sequence numbering  default throughput class assignment  packet retransmission  incoming call barred  outgoing called barred  oneway logical channel outgoing  oneway logical channel incoming  closed user group variety  reverse charging  reverse charging acceptance  rpoa selection  throughput class negotiation  fast select  fast select acceptance  dbit modification  datagram facility variety   packet window size selection flow control parameter bfe default packet size octet window size packet default parameter may changed approved defense communication agency requesting bic host administrator may specify nonstandard default packet size octet window size packet host administrator must also specify whether bfe negotiate value call call basis host administrator chooses negotiate bfe use value specified host administrator call incoming outgoing negotiation selected bfe offer packet size window size incoming call host may respond smaller size desired  emergency mode addressing one new facility code defined use blacker called emergency mode addressing facility defined section   precedence bfe reallocate resource based precedence facility supplied call request carry precedence packet across bfe call request opposite interface host supply precedence call request packet bfe assume precedence zero requested send call request network precedence zero allows host network continue act upon precedence call page  march  diagnostics code  bfe pass certain diagnostic information back host indicate status information communication path provide security related information diagnostic informa tion provided bfe becomes aware reportable event two example reportable event notice bfe network interface come bfe lost contact access control center however guarantee bfe able detect report anomalous situation occur underlying black network  diagnostic information sent diagnostic field x packet x diagnostic code bfe use value defined ccitt recommendation ddn specification following interpretation ddn diagnostic code psn unavailable indicate ddn packet switching node bfe connected unavailable ddn diagnostic code remote psn dead indicate destination bfe unreachable see appendix c full list diagnostic code may generated blacker  diagnostic information related emergency mode status see section  also passed host x level diagnostic packet may sent bfe following diagnostic code code entering emergency mode leaving emergency mode emergency mode window open clear indication packet may sent bfe follow ing diagnostic code code call failed  address translation information required call failed  emergency window open bfe emergency mode  emergency mode  one aspect blacker system operation ability communicate bfes absence access control center acc andor key distribution center kdcs capability referred emergency mode use emergency page  march mode may involve host processing condition exist could result bfe entering emergency mode bfes action depends upon startup parameter contained bic parameter specifies one three possible course action action remain normal mode ie communicate bfes operating emergency mode automatically enter emergency mode notify host notify host condition exist allow bfe enter emergency mode make transition emergency mode directed host paragraph   provide information emergency mode diagnostic code addressing  additionally since address translation table contained bfe maintained acc emergency mode bfe may able communicate acc host may limited host communicate emergency mode bfe continue able communicate host address translation providing access control passed optional x facility defined  allows host provide address translation information bfe must used host requires flexibility emergency mode  additional optional user facility supported facility allow dte provide ddn address black internet address destination bfe address specified call request facility accepted emergency mode enabled format     bit black  internet address  first byte facility identification code black internet address second byte contains length following parameter value field must always contain value four remaining byte contain black ip address destination host call address stored bit  octet bit  octet bit  octet bit  octet bit leftmost bit octet etc supplied address zero used tell bfe enter emergency mode sent response bfe message advertising opening emergency mode window  necessary host provide enter page  march emergency mode command along address translation information facility must appear twice call request packet enter emergency mode command appearing first  host administrator requested bfe never enter emergency mode host notified emergency mode window open close host whose administrator requested bfe always enter emergency mode notified via diagnostic code described  bfe enters exit emergency mode host administrator requested host participate bfe decision enter emergency mode bfe send emergency mode window open diagnostic host condition emergency mode exist host desire bfe enter emergency mode responds using emergency mode address facility  address set zero host wish enter emergency mode response necessary bfe restores contact administrative node send host leaving emergency mode diagnostic message  logical channel bfe support simul taneous open logical channel logical channel bfe defined intersection source x address destination x address x precedence  internet protocol feature  addition x interface bfe requires use ip defined mil std restriction use ip follows  ip address bit value consisting network identifier network specific host field different format address ddn red virtual network rvn class network net number following format see also   network host   host connected bfe provide red ip destination address actual destination datagram host also supply appropriate ddnrvn x address bfe case x address supplied host correspond actual destination red ip address case eg ip device directly connected bfe may page  march x address corresponding red gateway next hop actual red ip destination  maximum blacker ip datagram size eightbit byte octet required milstd para  ip datagrams octet sent assurance destination prepared accept larger datagram ip datagram must sent x complete packet sequence datagram fit within single x packet packet complete packet sequence must contain exactly one ip datagram ip datagrams sent multiple x packet incomplete datagrams unfinished packet sequence may sent one time single level host allowed send datagrams packet sequence host accredited send datagrams multiple security level must send receive datagrams single packet packet received host bit set result call cleared  ip datagrams must contain sensitivity label defined revised ip security option ipso described change milstd must first option ip datagrams blacker designed make cryptographic distinction eight hierarchical level sixteen nonhierarchical category appendix provides configuration used initial blacker deployment dsnet  bfe limited amount space available buffer datagrams datagrams authorization already exist bfe subject normal flow control procedure problem outgoing datagrams require new authorization however must buffered proper permission denial received acc five datagrams buffered bfe time receipt additional outgoing datagrams requiring communication acc overflow available buffer space datagrams discarded without notice order minimize likelihood event host administrator ensure key essential high volume destination marked preplacement time bic ordered acc administrator  blacker system support dual multiple homing host host must one bfe port connected network bfe connected host must different network internet address responsibility two host select bfe multihomed host used connection host blacker acc kdcs set multiple address page  march  internet control protocol feature  bfe also make use icmp message indicate certain information host  bfe respond icmp echo request message icmp echo reply message  bfe pass diagnostic information back host indicate status information communication path provide security related information diagnostic information provided bfe becomes aware reportable event however guarantee bfe able detect report anomalous situation  diagnostic information passed icmp message destination unreachable type message sent request denied message received bfe acc code host unreachable sent request denied message indicates destination bfe code communication destination host administratively prohibited sent request denied message indicates access denied page  march blackside network interface  section describes ddn interface blacker equipment connecting ddn host implementors need concern section except background assist ordering proper type interface line dca  physical level bfe confirm following specification  defense data network x host interface specification  dca december eia standard r november military standard  march bfe support signal listed table b ddn x specification optional signal supported network side r term bfe support category circuit balanced mode bfe also support type sendreceive mandatory circuit synchronous primary channel operation see fig  specification r position connector glenair inc equal backshell used network interface bfe present dte interface network bfe operate speed  kilobit per second full duplex synchronous operation supported data timing originate dce note signal name used refer r name used following table rt signal supply data strobe rd st supply data request sd tt supply data acknowledgedata strobe sd implies dce control data transfer rate via rt st dte use st generate data strobe signal tt network dce supply timing blacker dte blacker dce supply timing host dte interface signal electrical characteristic defined milstd single deviation specification open circuit balanced voltage driver output volt  volt instead volt  volt interface signal function direction pin assignment defined r page  march listing signal supported bfe blackside pin r abbreviation dte shield connection si ib spare sd balanced generator st balanced receiver rd balanced receiver r balanced generator rt balanced receiver c balanced receiver  dm balanced receiver tr balanced generator rr balanced receiver rl  ic ib sfsr  tt balanced generator tm ib sg circuit ground rc dce circuit ground spare sd see pin st see pin rd see pin r see pin rt see pin c see pin  dm see pin tr see pin rr see pin s  sq ib n  tt see pin sb ib sc dte circuit ground abbreviation r signal name ib pin open internal bias minus five volt optional ib pin open internal bias five volt optional page  march  link level bfe conform following link level specification  defense data network x host interface specification  dca december  interface data terminal equipment dte data circuit termination equipment dce terminal operating packet mode public data network  recommendation x ccitt  wd x packet network interface lapb  western digital corp september preliminary april expected final date level bfe use ddn x high level data link control link access procedure balanced hdlclapb interface protocol psnblack side bfe dte hdlclapb interface bfe implemented using western digital wd packet network interface chip chip handle bit oriented full duplex serial data communication level level interface side computer interface side us direct memory access  transparent mode  wd chip described specification three used  packet level  bfe network interface ddn conforms ddn interface specification dated december  type service bfe interface offer ddn standard service interface network may operate ddn basic service interface network side  packet size bfe designed operate maximum packet size byte also operate byte operating maximum packet size le byte may significantly degrade performance  bfe make use interrupt service set dbit qbit page  march  call user data restriction protocol identification information x call bfe use cc hex binary indicate ip next higher level protocol ip used network interface value c hex binary used indicate next layer protocol encryption layer ip used black side bfe connection pas gateway black network  call request bfe support incoming call call request packet specify either logical physical address however capability issue declarative call request packet add delete logical name  internet protocol ip feature  bfe send ip datagrams byte  ip header bfe may include omit ip header network side sending various type datagrams datagrams marked accordance section  bfe use ip header sending datagrams gateway black network sending traffic encrypted eg icmp echo reply black network host  ip address bfe take ddnrvn address  generates black ip address via table lookup table bfe contains address translation bfe domain interdomain bfe address translation information table normally maintained access control center acc bfe however information table may also provided host bfe emergency mode   x address black x network address generated black ip address via algorithm defined ddn bfe support full ddn address translation algorithm physical logical address  internet control message protocol icmp feature  bfe capable receiving icmp message type generating least echo reply parameter problem destination unreachable message page  march initial ddn sensitivity label hierarchical level value code name undefined top secret secret confidential undefined undefined unclassified undefined nonhierarchical compartment value option type bit number name basic genser basic siopesi basic sci basic nsa undefined undefined undefined numbered left right page march b reference  defense data network x host interface specification  dca december available defense technical information center cameron station alexandria va  order number ada eia standard r november available electronic industry association eye street nw washington dc military standard  march available naval publication form center tabor avenue philadelphia pa  interface data terminal equipment dte data circuit terminating equipment dce terminal operating packet mode public data network  recommendation x ccitt available national technical information center usdepartment commerce springfield va order number pb  interface data terminal equipment dte data circuit terminating equipment dce operation packet switched data communication network  fedstd fips pub july also available national technical information center usdepartment commerce springfield va  wd x packet network interface lapb  western digital corp sept preliminary april final available western digital mccabe way irvine ca   revised internet protocol security option  department defense issued change mil std internet protocol mil std aug available naval publication form center tabor avenue philadelphia pa page b march c blacker generated diagnostic code diagnostic code value additional information invalid p invalid p r packet type invalid state r state r state p state p state p state state packet allowed packet short packet long restart nonzero lcgn lcn timer expired incoming call clear indication reset indication restart indication call setup problem facility code allowed facility parameter allowed invalid called address invalid calling address invalid facility length local psn unavailable network side interface came remote bfe dead local resource available remote resource available remote host red gateway unavailable remote psn black gateway unavailable calling logical address enabled calling logical name incorrect dte called logical name authorized called logical name enabled called logical name dtes page c march diagnostic code value logical addressing invalid black network standard service requested see  invalid protocol identification see  cleared due higher precedence call requested precedence high entering emergency mode see  leaving emergency mode see  emergency mode window open see  address translation needed see  emergency mode window open emergency mode see  diagnostic code sent clear indication call unfinished packet sequence multilevel host us bit bfe table resource full capacity logical channel idle timer expires host sends nonzero clear request code reset indication packet reassembly timer expires host sends nonzero reset request code page c 